<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vidje Records - Half Season Wrapped</title>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet">
<!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Vidje Tracking System -->
    <script src="vidje-tracking.js"></script>
    <style>
        :root {
            --red-primary: #E31B23;
            --red-glow: rgba(227, 27, 35, 0.6);
            --red-bright: #FF2D2D;
            --black: #0A0A0A;
            --white: #FFFFFF;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--black);
            color: var(--white);
            overflow: hidden;
            width: 100vw;
            height: 100vh;
            position: fixed;
        }

        /* Background texture with animation */
        .background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(45deg, transparent 48%, rgba(255,255,255,0.02) 50%, transparent 52%),
                linear-gradient(-45deg, transparent 48%, rgba(255,255,255,0.02) 50%, transparent 52%);
            background-size: 50px 50px;
            z-index: 0;
            animation: backgroundMove 20s linear infinite;
        }

        @keyframes backgroundMove {
            0% {
                background-position: 0 0, 25px 25px;
            }
            100% {
                background-position: 50px 50px, 75px 75px;
            }
        }

        /* Glowing liquid shapes with more movement */
        .liquid-shape {
            position: fixed;
            border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%;
            filter: blur(100px);
            opacity: 0.5;
            z-index: 1;
            animation: morph 12s ease-in-out infinite;
            will-change: transform, border-radius;
            transform: translateZ(0); /* Force hardware acceleration */
        }
        
        /* Reduce blur on mobile for better performance */
        @media (max-width: 768px) {
            .liquid-shape {
                filter: blur(50px);
                opacity: 0.3;
            }
        }

        .liquid-1 {
            top: -15%;
            right: -10%;
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, var(--red-bright), var(--red-primary), transparent);
            animation: morph 12s ease-in-out infinite, float1 8s ease-in-out infinite;
        }

        .liquid-2 {
            bottom: -15%;
            left: -10%;
            width: 450px;
            height: 450px;
            background: radial-gradient(circle, var(--red-primary), transparent);
            animation: morph 15s ease-in-out infinite, float2 10s ease-in-out infinite;
            animation-delay: 2s;
        }

        .liquid-3 {
            top: 50%;
            left: 50%;
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, var(--red-bright), transparent);
            animation: morph 10s ease-in-out infinite, float3 12s ease-in-out infinite;
            animation-delay: 4s;
        }

        .liquid-4 {
            top: 20%;
            left: -5%;
            width: 350px;
            height: 350px;
            background: radial-gradient(circle, var(--red-primary), transparent);
            animation: morph 13s ease-in-out infinite, float1 9s ease-in-out infinite;
            animation-delay: 6s;
        }

        @keyframes morph {
            0%, 100% {
                border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%;
            }
            25% {
                border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
            }
            50% {
                border-radius: 30% 60% 70% 40% / 50% 60% 30% 60%;
            }
            75% {
                border-radius: 70% 30% 50% 60% / 40% 70% 50% 30%;
            }
        }

        @keyframes float1 {
            0%, 100% {
                transform: translate(0, 0) rotate(0deg);
            }
            33% {
                transform: translate(30px, -30px) rotate(120deg);
            }
            66% {
                transform: translate(-20px, 20px) rotate(240deg);
            }
        }

        @keyframes float2 {
            0%, 100% {
                transform: translate(0, 0) rotate(0deg);
            }
            33% {
                transform: translate(-40px, 30px) rotate(-120deg);
            }
            66% {
                transform: translate(30px, -20px) rotate(-240deg);
            }
        }

        @keyframes float3 {
            0%, 100% {
                transform: translate(-50%, -50%) rotate(0deg) scale(1);
            }
            50% {
                transform: translate(-50%, -50%) rotate(180deg) scale(1.2);
            }
        }

        /* Floating particles */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10; /* Increased from 1 to ensure visibility */
            overflow: hidden;
        }

        .particle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: var(--red-bright);
            border-radius: 50%;
            opacity: 0;
            animation: particleFloat 15s infinite;
            box-shadow: 0 0 10px var(--red-bright);
            will-change: transform, opacity;
            transform: translateZ(0); /* Force hardware acceleration */
        }
        
        /* Reduce particle effects on mobile for better performance */
        @media (max-width: 768px) {
            .particle {
                box-shadow: 0 0 5px var(--red-bright); /* Lighter shadow */
                width: 4px; /* Slightly bigger on mobile */
                height: 4px;
            }
            
            /* Make particles more visible on mobile */
            @keyframes particleFloat {
                0% {
                    transform: translateY(100vh) translateX(0) scale(0);
                    opacity: 0;
                }
                10% {
                    opacity: 0.8; /* More visible */
                }
                90% {
                    opacity: 0.8; /* More visible */
                }
                100% {
                    transform: translateY(-100vh) translateX(100px) scale(1);
                    opacity: 0;
                }
            }
        }

        @keyframes particleFloat {
            0% {
                transform: translateY(100vh) translateX(0) scale(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) translateX(100px) scale(1);
                opacity: 0;
            }
        }

        /* Scanlines effect */
        .scanlines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                to bottom,
                transparent 50%,
                rgba(255, 255, 255, 0.02) 50%
            );
            background-size: 100% 4px;
            z-index: 2;
            pointer-events: none;
            animation: scanlineMove 8s linear infinite;
        }

        @keyframes scanlineMove {
            0% {
                transform: translateY(0);
            }
            100% {
                transform: translateY(4px);
            }
        }

        /* Main container */
        .container {
            position: relative;
            width: 100%;
            height: 100vh;
            height: 100dvh; /* Dynamic viewport height for mobile */
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2;
        }

        /* Slide system with better transitions */
        .slide {
            position: absolute;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 80px 30px 80px 30px;
            text-align: center;
            opacity: 0;
            transform: scale(0.8) rotateY(15deg);
            transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
            cursor: pointer;
        }

        .slide.active {
            display: flex;
            opacity: 1;
            transform: scale(1) rotateY(0deg);
            animation: slideIn 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        /* Tap indicator - hidden for clean look */
        .tap-indicator {
            display: none;
        }

        @keyframes slideIn {
            0% {
                opacity: 0;
                transform: scale(0.8) rotateY(15deg);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotateY(0deg);
            }
        }

        /* Typography with animations */
        .title-huge {
            font-family: 'Bebas Neue', sans-serif;
            font-size: clamp(40px, 10vw, 100px);
            font-weight: 900;
            line-height: 0.9;
            letter-spacing: 3px;
            text-transform: uppercase;
            margin-bottom: 20px;
            text-shadow: 
                0 0 20px var(--red-glow),
                0 0 40px var(--red-glow),
                0 0 60px var(--red-glow);
            animation: textGlow 3s ease-in-out infinite, textFloat 4s ease-in-out infinite;
        }

        @keyframes textGlow {
            0%, 100% {
                text-shadow: 
                    0 0 20px var(--red-glow),
                    0 0 40px var(--red-glow),
                    0 0 60px var(--red-glow);
            }
            50% {
                text-shadow: 
                    0 0 30px var(--red-glow),
                    0 0 60px var(--red-glow),
                    0 0 90px var(--red-glow);
            }
        }

        @keyframes textFloat {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        .title-large {
            font-family: 'Bebas Neue', sans-serif;
            font-size: clamp(32px, 7vw, 70px);
            font-weight: 900;
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-bottom: 15px;
            animation: fadeInUp 0.8s ease-out 0.2s backwards;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .subtitle {
            font-size: clamp(14px, 2.5vw, 20px);
            font-weight: 400;
            opacity: 0.8;
            margin-bottom: 20px;
            animation: fadeInUp 0.8s ease-out 0.4s backwards;
        }

        /* Stats Display with pulse animation */
        .stat-large {
            font-family: 'Bebas Neue', sans-serif;
            font-size: clamp(60px, 18vw, 180px);
            font-weight: 900;
            line-height: 1;
            background: linear-gradient(180deg, var(--white) 0%, var(--red-bright) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: drop-shadow(0 0 40px var(--red-glow));
            margin: 10px 0;
            animation: statPulse 2s ease-in-out infinite, fadeInScale 0.8s ease-out 0.3s backwards;
        }

        @keyframes statPulse {
            0%, 100% {
                transform: scale(1);
                filter: drop-shadow(0 0 40px var(--red-glow));
            }
            50% {
                transform: scale(1.05);
                filter: drop-shadow(0 0 60px var(--red-glow));
            }
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.5);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .stat-label {
            font-size: clamp(12px, 2vw, 18px);
            text-transform: uppercase;
            letter-spacing: 3px;
            opacity: 0.7;
            margin-top: 5px;
            animation: fadeInUp 0.8s ease-out 0.5s backwards;
        }

        /* Compliment text styling */
        .compliment-text {
            font-size: clamp(14px, 2.5vw, 20px);
            font-weight: 600;
            color: var(--red-bright);
            text-align: center;
            margin-top: 15px;
            padding: 12px 20px;
            background: rgba(227, 27, 35, 0.1);
            border-radius: 12px;
            border: 1px solid rgba(227, 27, 35, 0.3);
            max-width: 90%;
            margin-left: auto;
            margin-right: auto;
            animation: fadeInUp 0.8s ease-out 0.7s backwards, pulse 2s ease-in-out infinite;
            box-shadow: 0 4px 20px rgba(227, 27, 35, 0.2);
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 4px 20px rgba(227, 27, 35, 0.2);
            }
            50% {
                transform: scale(1.02);
                box-shadow: 0 6px 30px rgba(227, 27, 35, 0.3);
            }
        }

        /* List container for top items - optimized for mobile */
        .top-list {
            width: 100%;
            max-width: 500px;
            margin: 15px auto 0;
            display: flex;
            flex-direction: column;
            gap: 10px;
            overflow-y: auto;
            overflow-x: hidden;
            max-height: calc(100vh - 300px);
            max-height: calc(100dvh - 300px);
            padding: 5px;
            scrollbar-width: thin;
            scrollbar-color: var(--red-primary) transparent;
        }

        .top-list::-webkit-scrollbar {
            width: 4px;
        }

        .top-list::-webkit-scrollbar-track {
            background: transparent;
        }

        .top-list::-webkit-scrollbar-thumb {
            background: var(--red-primary);
            border-radius: 4px;
        }

        .top-item {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 12px 15px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            overflow: hidden;
            animation: slideInRight 0.6s ease-out backwards;
            animation-delay: calc(var(--item-index) * 0.1s);
        }

        .top-item:nth-child(1) { --item-index: 0; }
        .top-item:nth-child(2) { --item-index: 1; }
        .top-item:nth-child(3) { --item-index: 2; }
        .top-item:nth-child(4) { --item-index: 3; }
        .top-item:nth-child(5) { --item-index: 4; }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(-50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .top-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(227, 27, 35, 0.3), transparent);
            transition: left 0.6s ease;
        }

        .top-item::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(227, 27, 35, 0.1), transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .top-item:hover::before {
            left: 100%;
        }

        .top-item:hover::after {
            opacity: 1;
        }

        .top-item:hover {
            background: rgba(227, 27, 35, 0.15);
            border-color: var(--red-bright);
            transform: translateX(8px) scale(1.02);
            box-shadow: 
                0 8px 30px rgba(227, 27, 35, 0.4),
                inset 0 0 20px rgba(227, 27, 35, 0.1);
        }

        .item-rank {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 28px;
            color: var(--red-bright);
            min-width: 35px;
            text-align: center;
            animation: rankPulse 2s ease-in-out infinite;
            animation-delay: calc(var(--item-index) * 0.2s);
            text-shadow: 0 0 10px var(--red-glow);
        }

        @keyframes rankPulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
        }

        .item-image {
            width: 60px;
            height: 60px;
            border-radius: 10px;
            object-fit: cover;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            min-width: 60px;
        }

        .item-info {
            flex: 1;
            text-align: left;
        }

        .item-name {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 3px;
            color: var(--white);
        }

        .item-stat {
            font-size: 13px;
            opacity: 0.7;
        }

        /* Progress bar */
        .progress-container {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: rgba(255, 255, 255, 0.1);
            z-index: 100;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--red-primary), var(--red-bright));
            width: 11.11%;
            transition: width 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 0 10px var(--red-bright);
        }

        /* Counter */
        .counter {
            position: fixed;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 10px 20px;
            border-radius: 30px;
            font-family: 'Bebas Neue', sans-serif;
            font-size: 16px;
            letter-spacing: 1px;
            z-index: 100;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* Buttons */
        .btn {
            background: var(--red-primary);
            color: var(--white);
            border: none;
            padding: 15px 35px;
            font-size: 20px;
            font-weight: 700;
            margin: 8px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            text-transform: uppercase;
            letter-spacing: 1px;
            border-radius: 50px;
            font-family: 'Poppins', sans-serif;
            box-shadow: 0 10px 30px rgba(227, 27, 35, 0.4);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transition: width 0.6s, height 0.6s, top 0.6s, left 0.6s;
            transform: translate(-50%, -50%);
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn:hover {
            transform: scale(1.05) translateY(-2px);
            box-shadow: 0 15px 40px rgba(227, 27, 35, 0.6);
        }

        .btn-secondary {
            background: transparent;
            border: 2px solid var(--red-primary);
            box-shadow: none;
        }

        .btn-secondary:hover {
            background: var(--red-primary);
            box-shadow: 0 15px 40px rgba(227, 27, 35, 0.6);
        }

        /* Summary grid */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            max-width: 500px;
            margin: 20px auto;
            width: 100%;
        }

        .summary-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            padding: 20px;
            transition: all 0.4s ease;
            animation: fadeInUp 0.8s ease-out backwards;
            animation-delay: calc(var(--card-index) * 0.1s);
        }

        .summary-card:nth-child(1) { --card-index: 0; }
        .summary-card:nth-child(2) { --card-index: 1; }
        .summary-card:nth-child(3) { --card-index: 2; }
        .summary-card:nth-child(4) { --card-index: 3; }

        .summary-card:hover {
            background: rgba(227, 27, 35, 0.1);
            border-color: var(--red-bright);
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 10px 30px rgba(227, 27, 35, 0.3);
        }

        .summary-card {
            cursor: pointer;
            position: relative;
        }

        .summary-card.clickable::after {
            content: 'üëÅÔ∏è';
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 20px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .summary-card.clickable:hover::after {
            opacity: 0.7;
        }

        /* Modal Overlay */
        .overlay-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.95);
            z-index: 10000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }

        .overlay-modal.active {
            display: flex;
        }

        .overlay-content {
            position: relative;
            max-width: 90vw;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            animation: zoomIn 0.4s ease;
        }

        .overlay-image {
            max-width: 500px;
            max-height: 500px;
            width: 100%;
            border-radius: 20px;
            box-shadow: 0 30px 80px rgba(227, 27, 35, 0.5);
            margin-bottom: 30px;
        }

        .overlay-info {
            text-align: center;
            padding: 20px;
        }

        .overlay-title {
            font-family: 'Bebas Neue', sans-serif;
            font-size: clamp(32px, 6vw, 48px);
            color: var(--red-bright);
            margin-bottom: 10px;
            text-shadow: 0 0 20px var(--red-glow);
        }

        .overlay-subtitle {
            font-size: clamp(18px, 3vw, 24px);
            margin-bottom: 15px;
            font-weight: 600;
        }

        .overlay-stats {
            font-size: clamp(14px, 2vw, 16px);
            opacity: 0.8;
        }

        .overlay-close {
            position: absolute;
            top: -50px;
            right: 0;
            background: var(--red-primary);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .overlay-close:hover {
            background: var(--red-bright);
            transform: rotate(90deg);
        }

        @keyframes zoomIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Data-only overlay (no image) */
        .overlay-content.data-only .overlay-image {
            display: none;
        }

        .overlay-content.data-only .overlay-info {
            padding: 60px 40px;
            background: linear-gradient(135deg, rgba(227, 27, 35, 0.15) 0%, rgba(227, 27, 35, 0.05) 100%);
            border: 2px solid rgba(227, 27, 35, 0.3);
            border-radius: 30px;
            backdrop-filter: blur(20px);
            min-width: 400px;
            box-shadow: 0 20px 60px rgba(227, 27, 35, 0.3);
        }

        .overlay-content.data-only .overlay-title {
            font-size: clamp(64px, 12vw, 96px);
            margin-bottom: 20px;
            line-height: 1;
        }

        .overlay-content.data-only .overlay-subtitle {
            font-size: clamp(20px, 4vw, 28px);
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .overlay-content.data-only .overlay-stats {
            font-size: clamp(16px, 3vw, 20px);
            opacity: 0.7;
            max-width: 500px;
            line-height: 1.6;
        }

        .summary-number {
            font-family: 'Bebas Neue', sans-serif;
            font-size: clamp(36px, 10vw, 48px);
            font-weight: 900;
            color: var(--red-bright);
            margin-bottom: 5px;
            text-shadow: 0 0 20px var(--red-glow);
        }

        .summary-label {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 2px;
            opacity: 0.7;
        }

        /* Vinyl record */
        .vinyl-container {
            width: 220px;
            height: 220px;
            margin: 20px auto;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .vinyl-container:hover {
            transform: scale(1.05);
        }

        .vinyl-record {
            width: 100%;
            height: 100%;
            position: relative;
            background: radial-gradient(circle, #1a1a1a 0%, #000 70%);
            border-radius: 50%;
            box-shadow: 
                0 0 20px rgba(0,0,0,0.8),
                inset 0 0 30px rgba(0,0,0,0.9),
                0 5px 15px rgba(0,0,0,0.5);
            animation: vinylSpin 4s linear infinite;
        }

        .vinyl-record.paused {
            animation-play-state: paused;
        }

        @keyframes vinylSpin {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }

        .vinyl-grooves {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.3;
        }

        .vinyl-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: #2a2a2a;
            box-shadow: 
                0 0 10px rgba(0,0,0,0.8),
                inset 0 0 15px rgba(255,255,255,0.1);
            overflow: hidden;
        }

        .album-photo {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        /* Responsive adjustments for mobile */

        /* TABLET: Medium size mini player */
        @media (min-width: 769px) and (max-width: 1024px) {
            .mini-player {
                width: 280px;
                padding: 10px 14px;
            }
            
            .mini-player-cover {
                width: 40px;
                height: 40px;
            }
            
            .mini-player-toggle {
                left: 320px; /* Adjust for smaller mini player */
            }
        }

        @media (max-width: 768px) {
            .slide {
                padding: 60px 20px 70px 20px;
            }

            .top-list {
                max-width: 100%;
                max-height: calc(100dvh - 280px);
                gap: 8px;
            }

            .top-item {
                padding: 10px 12px;
                gap: 10px;
            }

            .item-rank {
                font-size: 24px;
                min-width: 30px;
            }

            .item-image {
                width: 50px;
                height: 50px;
                min-width: 50px;
            }

            .item-name {
                font-size: 14px;
            }

            .item-stat {
                font-size: 12px;
            }

            .summary-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
                max-width: 100%;
            }

            .summary-card {
                padding: 15px;
            }

            .counter {
                top: 10px;
                right: 10px;
                font-size: 14px;
                padding: 8px 15px;
            }

            .btn {
                padding: 12px 30px;
                font-size: 18px;
                margin: 6px;
            }

            .liquid-1, .liquid-2, .liquid-3, .liquid-4 {
                width: 300px;
                height: 300px;
            }
        }

        .overlay-modal {
            padding: 20px;
        }

        .overlay-image {
            max-width: 300px;
            max-height: 300px;
        }

        .overlay-close {
            top: -40px;
            width: 35px;
            height: 35px;
            font-size: 20px;
        }

        .summary-card img {
            width: 100px !important;
            height: 100px !important;
        }

        @media (max-width: 480px) {
            .title-huge {
                font-size: clamp(32px, 10vw, 70px);
                letter-spacing: 1px;
            }

            .title-large {
                font-size: clamp(28px, 7vw, 50px);
                margin-bottom: 10px;
            }

            .subtitle {
                font-size: clamp(13px, 2.5vw, 16px);
                margin-bottom: 15px;
            }

            .stat-large {
                font-size: clamp(50px, 18vw, 120px);
            }

            .stat-label {
                font-size: clamp(11px, 2vw, 14px);
            }

            .top-list {
                max-height: calc(100dvh - 260px);
            }

            .summary-grid {
                gap: 10px;
            }

            .summary-card {
                padding: 12px;
            }

            .summary-number {
                font-size: clamp(30px, 8vw, 40px);
            }

            .summary-label {
                font-size: 11px;
            }

            .btn {
                padding: 10px 25px;
                font-size: 16px;
            }
        }

        /* Prevent overscroll on mobile */
        @media (max-width: 768px) {
            body {
                overscroll-behavior: none;
                touch-action: pan-y;
            }

            .slide {
                overscroll-behavior: contain;
            }

            /* Data-only overlay responsive */
            .overlay-content.data-only .overlay-info {
                padding: 40px 25px;
                min-width: auto;
                width: 90vw;
                max-width: 400px;
                border-radius: 20px;
            }

            .overlay-content.data-only .overlay-title {
                font-size: clamp(48px, 15vw, 72px);
                margin-bottom: 15px;
            }

            .overlay-content.data-only .overlay-subtitle {
                font-size: clamp(16px, 4.5vw, 22px);
                margin-bottom: 15px;
            }

            .overlay-content.data-only .overlay-stats {
                font-size: clamp(13px, 3.5vw, 16px);
                padding: 0 10px;
            }
        }

        @media (max-width: 480px) {
            /* Extra small mobile - data-only overlay */
            .overlay-content.data-only .overlay-info {
                padding: 30px 20px;
                width: 85vw;
                border-radius: 15px;
            }

            .overlay-content.data-only .overlay-title {
                font-size: clamp(40px, 18vw, 64px);
                margin-bottom: 12px;
            }

            .overlay-content.data-only .overlay-subtitle {
                font-size: clamp(14px, 5vw, 20px);
                margin-bottom: 12px;
            }

            .overlay-content.data-only .overlay-stats {
                font-size: clamp(12px, 4vw, 15px);
                line-height: 1.5;
            }
        }

        /* Mini Music Player */
        .mini-player {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 340px;
            background: rgba(20, 20, 20, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 12px;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4), 0 0 0 1px rgba(255, 255, 255, 0.1);
            z-index: 1000;
            transition: left 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .mini-player.active {
            left: 20px;
        }

        .mini-player.hidden {
            left: -400px;
        }

        .mini-player-cover {
            width: 50px;
            height: 50px;
            border-radius: 6px;
            object-fit: cover;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .mini-player-info {
            flex: 1;
            min-width: 0;
            overflow: hidden;
        }

        .mini-player-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--white);
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            display: inline-block;
            max-width: 100%;
        }
        
        /* Marquee animation for long titles - works on all devices */
        .mini-player-info:hover .mini-player-title {
            animation: marquee 8s linear infinite;
        }
        
        @keyframes marquee {
            0% { transform: translateX(0); }
            100% { transform: translateX(calc(-100% + 200px)); }
        }

        .mini-player-artist {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .mini-player-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--red-primary);
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .mini-player-btn:hover {
            background: var(--red-bright);
            transform: scale(1.05);
        }

        .mini-player-btn:active {
            transform: scale(0.95);
        }

        /* Toggle button for mini player */
        .mini-player-toggle {
            position: fixed;
            bottom: 35px;
            left: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(227, 27, 35, 0.9);
            backdrop-filter: blur(10px);
            border: none;
            color: white;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 999;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(227, 27, 35, 0.4);
        }

        .mini-player-toggle.show {
            display: flex;
        }

        
        /* When mini player is hidden, move toggle to left side */
        .mini-player.hidden ~ .mini-player-toggle {
            left: 20px;
        }

        .mini-player-toggle:hover {
            background: var(--red-bright);
            transform: scale(1.1);
        }

        .mini-player-toggle:active {
            transform: scale(0.9);
        }

        /* Playing animation for song items */
        .top-item.playing {
            background: rgba(227, 27, 35, 0.15);
            border-left: 3px solid var(--red-primary);
        }

        .top-item.playing .item-name {
            color: var(--red-primary);
        }

        /* Make song items clickable */
        .top-item.clickable {
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .top-item.clickable:hover {
            background: rgba(255, 255, 255, 0.05);
            transform: translateX(5px);
        }

        /* Artist Overlay Styles */
        .artist-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .artist-overlay.active {
            display: flex;
            opacity: 1;
        }

        .artist-overlay-content {
            background: rgba(20, 20, 20, 0.98);
            border: 2px solid var(--red-primary);
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 20px 60px rgba(227, 27, 35, 0.5);
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .artist-overlay-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            color: white;
        }

        .artist-overlay-close:hover {
            background: var(--red-primary);
            transform: rotate(90deg);
        }

        .artist-overlay-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .artist-overlay-image {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--red-primary);
            box-shadow: 0 0 20px rgba(227, 27, 35, 0.5);
        }

        .artist-overlay-info {
            flex: 1;
        }

        .artist-overlay-title {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 28px;
            color: var(--red-primary);
            margin-bottom: 5px;
            text-shadow: 0 0 10px rgba(227, 27, 35, 0.5);
        }

        .artist-overlay-subtitle {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .artist-overlay-songs {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .artist-song-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .artist-song-item:hover {
            background: rgba(227, 27, 35, 0.1);
            border-color: var(--red-primary);
            transform: translateX(5px);
        }

        .artist-song-item.playing {
            background: rgba(227, 27, 35, 0.2);
            border-color: var(--red-primary);
            border-left: 3px solid var(--red-primary);
        }

        .artist-song-rank {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 24px;
            color: var(--red-primary);
            min-width: 30px;
            text-align: center;
        }

        .artist-song-cover {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            object-fit: cover;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .artist-song-info {
            flex: 1;
            min-width: 0;
        }

        .artist-song-name {
            font-size: 15px;
            font-weight: 600;
            color: white;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .artist-song-play-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--red-primary);
            border: none;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .artist-song-play-btn:hover {
            background: var(--red-bright);
            transform: scale(1.1);
        }

        /* Mobile responsive for overlay */
        @media (max-width: 768px) {
            .artist-overlay-content {
                padding: 20px;
                max-width: 95%;
                max-height: 85vh;
            }

            .artist-overlay-header {
                gap: 15px;
                margin-bottom: 20px;
            }

            .artist-overlay-image {
                width: 60px;
                height: 60px;
            }

            .artist-overlay-title {
                font-size: 24px;
            }

            .artist-overlay-subtitle {
                font-size: 12px;
            }

            .artist-song-item {
                padding: 12px;
                gap: 12px;
            }

            .artist-song-cover {
                width: 45px;
                height: 45px;
            }
        }

        @media (max-width: 768px) {
            /* MOBILE: Very small mini player */
            .mini-player {
                width: 200px; /* SANGAT KECIL */
                left: -220px;
                bottom: 15px;
                padding: 8px 10px;
                gap: 8px;
                border-radius: 8px;
            }

            .mini-player.active {
                left: 15px; /* Di kiri bawah */
            }

            .mini-player.hidden {
                left: -220px;
            }

            .mini-player-cover {
                width: 35px; /* Cover kecil */
                height: 35px;
                border-radius: 4px;
            }

            .mini-player-info {
                max-width: 80px; /* Info area kecil */
                overflow: hidden;
            }

            .mini-player-title {
                font-size: 11px; /* Text kecil */
                font-weight: 700;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }
            
            /* Auto marquee on mobile for long text */
            .mini-player-info:hover .mini-player-title,
            .mini-player.active .mini-player-title {
                animation: marquee-mobile 8s linear infinite;
            }
            
            @keyframes marquee-mobile {
                0%, 10% { transform: translateX(0); }
                90%, 100% { transform: translateX(calc(-100% + 80px)); }
            }

            .mini-player-artist {
                font-size: 9px; /* Artist kecil */
                display: block;
            }

            .mini-player-btn {
                width: 30px; /* Button kecil */
                height: 30px;
            }
            
            .mini-player-btn svg {
                width: 12px;
                height: 12px;
            }

            /* Toggle button di KANAN mini player */
            .mini-player-toggle {
                bottom: 25px;
                left: 235px; /* 15px (mini left) + 200px (width) + 20px (gap) */
                width: 35px;
                height: 35px;
            }
            
            .mini-player-toggle svg {
                width: 16px;
                height: 16px;
            }
            
            .mini-player.hidden ~ .mini-player-toggle {
                left: 15px !important;
            }
        }

        /* ===== SONG PLAYER OVERLAY ===== */
        .song-player-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(30px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 99999;
            animation: fadeIn 0.3s ease;
        }

        .song-player-overlay.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .song-player-content {
            width: 90%;
            max-width: 450px;
            background: linear-gradient(145deg, rgba(227, 27, 35, 0.1), rgba(0, 0, 0, 0.3));
            backdrop-filter: blur(40px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 30px;
            padding: 40px 30px 30px;
            text-align: center;
            position: relative;
            box-shadow: 
                0 30px 80px rgba(0, 0, 0, 0.7),
                0 0 100px rgba(227, 27, 35, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            animation: slideUp 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .song-player-close {
            position: absolute;
            top: -15px;
            right: -15px;
            width: 55px;
            height: 55px;
            border-radius: 50%;
            background: linear-gradient(145deg, var(--red-primary), var(--red-bright));
            border: 3px solid rgba(255, 255, 255, 0.2);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 100;
            box-shadow: 
                0 5px 20px rgba(227, 27, 35, 0.5),
                0 0 0 0 rgba(227, 27, 35, 0.4);
            animation: pulseGlow 2s ease-in-out infinite;
        }

        @keyframes pulseGlow {
            0%, 100% {
                box-shadow: 
                    0 5px 20px rgba(227, 27, 35, 0.5),
                    0 0 0 0 rgba(227, 27, 35, 0.4);
            }
            50% {
                box-shadow: 
                    0 5px 30px rgba(227, 27, 35, 0.7),
                    0 0 0 10px rgba(227, 27, 35, 0);
            }
        }

        .song-player-close:hover {
            transform: rotate(90deg) scale(1.15);
            background: linear-gradient(145deg, var(--red-bright), #ff4444);
            box-shadow: 0 8px 30px rgba(255, 0, 0, 0.6);
        }

        .song-player-close:active {
            transform: rotate(90deg) scale(0.95);
        }

        .song-player-cover-wrapper {
            position: relative;
            width: 280px;
            height: 280px;
            margin: 0 auto 30px;
        }

        .song-player-cover {
            width: 100%;
            height: 100%;
            border-radius: 20px;
            box-shadow: 
                0 25px 70px rgba(0, 0, 0, 0.6),
                0 0 0 1px rgba(255, 255, 255, 0.1),
                inset 0 0 50px rgba(0, 0, 0, 0.3);
            object-fit: cover;
            animation: coverFloat 4s ease-in-out infinite;
        }

        @keyframes coverFloat {
            0%, 100% {
                transform: translateY(0) scale(1);
                box-shadow: 
                    0 25px 70px rgba(0, 0, 0, 0.6),
                    0 0 0 1px rgba(255, 255, 255, 0.1);
            }
            50% {
                transform: translateY(-12px) scale(1.02);
                box-shadow: 
                    0 35px 90px rgba(227, 27, 35, 0.4),
                    0 0 0 1px rgba(255, 255, 255, 0.2);
            }
        }

        .song-player-info {
            margin-bottom: 35px;
        }

        .song-player-title {
            font-size: 26px;
            font-weight: 700;
            color: white;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
            line-height: 1.3;
        }

        .song-player-artist {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.75);
            font-weight: 500;
        }

        .song-player-progress-container {
            width: 100%;
            margin-bottom: 12px;
        }

        .song-player-progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            cursor: pointer;
            position: relative;
            transition: height 0.2s ease;
        }

        .song-player-progress-bar:hover {
            height: 10px;
        }

        .song-player-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--red-primary), var(--red-bright));
            width: 0%;
            transition: width 0.1s linear;
            box-shadow: 0 0 15px var(--red-bright);
            position: relative;
        }

        .song-player-progress-fill::after {
            content: '';
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 14px;
            height: 14px;
            background: white;
            border-radius: 50%;
            box-shadow: 
                0 0 10px rgba(227, 27, 35, 0.8),
                0 2px 5px rgba(0, 0, 0, 0.3);
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .song-player-progress-bar:hover .song-player-progress-fill::after {
            opacity: 1;
        }

        .song-player-time {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 10px;
            font-weight: 500;
        }

        .song-player-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        .song-player-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(145deg, var(--red-primary), var(--red-bright));
            border: none;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 
                0 10px 30px rgba(227, 27, 35, 0.5),
                inset 0 -2px 0 rgba(0, 0, 0, 0.2),
                inset 0 2px 0 rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }

        .song-player-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transition: width 0.4s ease, height 0.4s ease;
        }

        .song-player-btn:hover::before {
            width: 100%;
            height: 100%;
        }

        .song-player-btn:hover {
            transform: scale(1.1);
            box-shadow: 
                0 15px 50px rgba(227, 27, 35, 0.7),
                inset 0 -2px 0 rgba(0, 0, 0, 0.2),
                inset 0 2px 0 rgba(255, 255, 255, 0.3);
        }

        .song-player-btn:active {
            transform: scale(0.95);
            box-shadow: 
                0 5px 20px rgba(227, 27, 35, 0.5),
                inset 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        /* Mobile responsive */
        @media (max-width: 768px) {
            .song-player-content {
                width: 95%;
                padding: 35px 25px 25px;
            }

            .song-player-cover-wrapper {
                width: 240px;
                height: 240px;
            }

            .song-player-title {
                font-size: 22px;
            }

            .song-player-artist {
                font-size: 14px;
            }

            .song-player-close {
                width: 50px;
                height: 50px;
                top: -12px;
                right: -12px;
            }

            .song-player-btn {
                width: 65px;
                height: 65px;
            }
        }


        /* Splash Screen */
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: var(--black);
            z-index: 20000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 1;
            transition: opacity 0.8s ease, visibility 0.8s ease;
            padding: 20px;
            overflow: hidden;
        }

        .splash-screen.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        /* Background elements untuk splash screen */
        .splash-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(45deg, transparent 48%, rgba(255,255,255,0.02) 50%, transparent 52%),
                linear-gradient(-45deg, transparent 48%, rgba(255,255,255,0.02) 50%, transparent 52%);
            background-size: 50px 50px;
            z-index: -2;
            animation: backgroundMove 20s linear infinite;
        }

        .splash-liquid-1 {
            position: fixed;
            top: -15%;
            right: -10%;
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, var(--red-bright), var(--red-primary), transparent);
            border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%;
            filter: blur(100px);
            opacity: 0.5;
            z-index: -1;
            animation: morph 12s ease-in-out infinite, float1 8s ease-in-out infinite;
        }

        .splash-liquid-2 {
            position: fixed;
            bottom: -15%;
            left: -10%;
            width: 450px;
            height: 450px;
            background: radial-gradient(circle, var(--red-primary), transparent);
            border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%;
            filter: blur(100px);
            opacity: 0.5;
            z-index: -1;
            animation: morph 15s ease-in-out infinite, float2 10s ease-in-out infinite;
            animation-delay: 2s;
        }

        .splash-liquid-3 {
            position: fixed;
            top: 50%;
            left: 50%;
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, var(--red-bright), transparent);
            border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%;
            filter: blur(100px);
            opacity: 0.3;
            z-index: -1;
            animation: morph 10s ease-in-out infinite, float3 12s ease-in-out infinite;
            animation-delay: 4s;
        }

        .splash-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .splash-content {
            position: relative;
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .splash-logo {
            font-family: 'Bebas Neue', sans-serif;
            font-size: clamp(64px, 18vw, 140px);
            color: var(--red-bright);
            text-shadow: 
                0 0 40px var(--red-glow),
                0 0 80px var(--red-glow),
                0 10px 30px rgba(0, 0, 0, 0.5);
            margin-bottom: 10px;
            letter-spacing: 12px;
            animation: splashPulse 2s ease-in-out infinite, floatLogo 3s ease-in-out infinite;
        }

        @keyframes splashPulse {
            0%, 100% {
                text-shadow: 
                    0 0 40px var(--red-glow),
                    0 0 80px var(--red-glow),
                    0 10px 30px rgba(0, 0, 0, 0.5);
            }
            50% {
                text-shadow: 
                    0 0 60px var(--red-glow), 
                    0 0 100px var(--red-glow),
                    0 0 120px var(--red-glow),
                    0 10px 30px rgba(0, 0, 0, 0.5);
            }
        }

        @keyframes floatLogo {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        .splash-subtitle {
            font-size: clamp(13px, 3vw, 18px);
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 60px;
            text-align: center;
            letter-spacing: 4px;
            text-transform: uppercase;
            font-weight: 300;
        }

        .splash-greeting {
            font-size: clamp(22px, 5vw, 40px);
            color: white;
            margin-bottom: 15px;
            text-align: center;
            font-weight: 600;
            animation: fadeInUp 0.8s ease-out 0.3s backwards;
        }

        .splash-username {
            font-size: clamp(28px, 7vw, 56px);
            color: var(--red-bright);
            margin-bottom: 35px;
            text-align: center;
            font-weight: 700;
            text-shadow: 0 0 30px var(--red-glow);
            animation: fadeInUp 0.8s ease-out 0.5s backwards;
        }

        .splash-question {
            font-size: clamp(18px, 4vw, 28px);
            color: rgba(255, 255, 255, 0.85);
            margin-bottom: 60px;
            text-align: center;
            font-weight: 400;
            animation: fadeInUp 0.8s ease-out 0.7s backwards;
        }

        .splash-btn {
            background: linear-gradient(135deg, var(--red-primary), var(--red-bright));
            border: none;
            color: white;
            padding: 22px 70px;
            font-size: clamp(20px, 4.5vw, 28px);
            font-weight: 700;
            border-radius: 60px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: 
                0 15px 40px rgba(227, 27, 35, 0.5),
                0 0 0 0 rgba(227, 27, 35, 0.4);
            font-family: 'Poppins', sans-serif;
            text-transform: uppercase;
            letter-spacing: 3px;
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.8s ease-out 0.9s backwards, pulse 2s ease-in-out 1.5s infinite;
        }

        .splash-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .splash-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .splash-btn:hover {
            transform: translateY(-8px) scale(1.08);
            box-shadow: 
                0 20px 50px rgba(227, 27, 35, 0.7),
                0 0 0 8px rgba(227, 27, 35, 0.2);
        }

        .splash-btn:active {
            transform: translateY(-3px) scale(1.03);
        }

        .splash-btn span {
            position: relative;
            z-index: 1;
        }

        @keyframes pulse {
            0%, 100% {
                box-shadow: 
                    0 15px 40px rgba(227, 27, 35, 0.5),
                    0 0 0 0 rgba(227, 27, 35, 0.4);
            }
            50% {
                box-shadow: 
                    0 15px 40px rgba(227, 27, 35, 0.5),
                    0 0 0 15px rgba(227, 27, 35, 0);
            }
        }

        @media (max-width: 768px) {
            .splash-liquid-1, .splash-liquid-2, .splash-liquid-3 {
                width: 300px;
                height: 300px;
            }
            
            .splash-btn {
                padding: 18px 50px;
            }
        }
    
        /* Home Button Style */
        .home-button {
            position: fixed;
            top: 20px;
            left: 20px;
            width: 50px;
            height: 50px;
            background: transparent;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1000;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .home-button:hover {
            transform: scale(1.15);
            filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.8));
        }

        .home-button svg {
            width: 28px;
            height: 28px;
            fill: white;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5));
            transition: all 0.3s ease;
        }


        /* Mute Button Style */
        .mute-button {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: transparent;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .mute-button:hover {
            transform: scale(1.15);
            filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.8));
        }

        .mute-button svg {
            width: 28px;
            height: 28px;
            fill: white;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5));
            transition: all 0.3s ease;
        }

        .mute-button.muted svg {
            fill: #E31B23;
            filter: drop-shadow(0 0 8px rgba(227, 27, 35, 0.8));
        }

        /* ANIMASI SHAKE (untuk mute) */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
        }

        /* ANIMASI PULSE (untuk unmute) */
        @keyframes unmutePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        /* Kembali Button Style (untuk slide akhir) */
        .btn-home {
            background: rgba(227, 27, 35, 0.9);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 15px 40px;
            font-size: 18px;
            font-weight: 700;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin: 10px;
            text-decoration: none;
            display: inline-block;
        }

        .btn-home:hover {
            background: rgba(255, 45, 45, 1);
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(227, 27, 35, 0.5);
        }

        @media (max-width: 768px) {
            .home-button {
                width: 45px;
                height: 45px;
                top: 15px;
                left: 15px;
            }

            .home-button svg {
                width: 24px;
                height: 24px;
            }

            .mute-button {
                width: 45px;
                height: 45px;
                top: 15px;
                right: 15px;
            }

            .mute-button svg {
                width: 24px;
                height: 24px;
            }

            .btn-home {
                padding: 12px 30px;
                font-size: 16px;
            }
        }

        
        @keyframes tapPulse {
            0%, 100% {
                opacity: 0.6;
                transform: translateY(0);
            }
            50% {
                opacity: 1;
                transform: translateY(5px);
            }
        }
    </style>
</head>
<body>
    <!-- Splash Screen -->
    <div class="splash-screen" id="splashScreen">
        <!-- Background Effects -->
        <div class="splash-background"></div>
        <div class="splash-liquid-1"></div>
        <div class="splash-liquid-2"></div>
        <div class="splash-liquid-3"></div>
        <div class="splash-particles" id="splashParticles"></div>
        
        <!-- Content -->
        <div class="splash-content">
            <div class="splash-logo">VIDJE</div>
            <div class="splash-subtitle">WRAPPED THIS WEEK</div>
            
            <div class="splash-greeting">Halo,</div>
            <div class="splash-username" id="splashUsername">User</div>
            <div class="splash-question">Siap melihat musikmu?</div>
            
            <button class="splash-btn" onclick="startWrapped()"><span>MULAI SEKARANG</span></button>
        </div>
    </div>

    <!-- Song Player Overlay -->
    <div class="song-player-overlay" id="songPlayerOverlay">
        <div class="song-player-content" onclick="event.stopPropagation()">
            <button class="song-player-close" onclick="closeSongPlayer(event)">
                <svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round">
                    <path d="M18 6L6 18M6 6l12 12"/>
                </svg>
            </button>
            
            <div class="song-player-cover-wrapper">
                <img src="/api/placeholder/400/400" alt="Cover" class="song-player-cover" id="songPlayerCover">
            </div>
            
            <div class="song-player-info">
                <div class="song-player-title" id="songPlayerTitle">Song Title</div>
                <div class="song-player-artist" id="songPlayerArtist">Artist Name</div>
            </div>
            
            <div class="song-player-progress-container">
                <div class="song-player-progress-bar" id="songPlayerProgressBar">
                    <div class="song-player-progress-fill" id="songPlayerProgressFill"></div>
                </div>
                <div class="song-player-time">
                    <span id="songPlayerCurrentTime">0:00</span>
                    <span id="songPlayerDuration">0:00</span>
                </div>
            </div>
            
            <div class="song-player-controls">
                <button class="song-player-btn" id="songPlayerPlayBtn" onclick="toggleSongPlayer()">
                    <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor" id="songPlayerPlayIcon">
                        <path d="M8 5v14l11-7z"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- Mini Music Player -->
    <div class="mini-player" id="miniPlayer" onclick="event.stopPropagation()">
        <img src="" alt="Cover" class="mini-player-cover" id="miniPlayerCover" style="cursor: pointer;">
        <div class="mini-player-info" style="cursor: pointer;">
            <div class="mini-player-title" id="miniPlayerTitle">-</div>
            <div class="mini-player-artist" id="miniPlayerArtist">-</div>
        </div>
        <button class="mini-player-btn" id="miniPlayerBtn" onclick="event.stopPropagation(); toggleMiniPlayer()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" id="miniPlayerIcon">
                <path d="M8 5v14l11-7z"/>
            </svg>
        </button>
    </div>

    <!-- Toggle button to show/hide mini player -->
    <button class="mini-player-toggle" id="miniPlayerToggle" onclick="event.stopPropagation(); toggleMiniPlayerVisibility()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" id="toggleIcon">
            <path d="M15 18l-6-6 6-6"/>
        </svg>
    </button>

    <!-- Artist Songs Overlay -->
    <div class="artist-overlay" id="artistOverlay">
        <div class="artist-overlay-content">
            <button class="artist-overlay-close" onclick="event.stopPropagation(); closeArtistOverlay()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 6L6 18M6 6l12 12"/>
                </svg>
            </button>
            <div class="artist-overlay-header">
                <img src="" alt="" class="artist-overlay-image" id="artistOverlayImage">
                <div class="artist-overlay-info">
                    <div class="artist-overlay-title" id="artistOverlayTitle">Artist Name</div>
                    <div class="artist-overlay-subtitle" id="artistOverlaySubtitle">Top Songs</div>
                </div>
            </div>
            <div class="artist-overlay-songs" id="artistOverlaySongs">
                <!-- Songs will be populated here -->
            </div>
        </div>
    </div>

    <!-- Hidden audio element -->
    <audio id="audioPlayer" preload="metadata"></audio>

    <!-- Background effects -->
    <div class="background"></div>
    <div class="liquid-shape liquid-1"></div>
    <div class="liquid-shape liquid-2"></div>
    <div class="liquid-shape liquid-3"></div>
    <div class="liquid-shape liquid-4"></div>
    <div class="scanlines"></div>
    
    <!-- Floating particles -->
    <div class="particles" id="particles"></div>

    <!-- Progress bar -->
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <!-- Main container -->
    <div class="container">
        
        <!-- Slide 1: Intro -->
        <div class="slide">
            <div class="title-huge">VIDJE RECORDS<br>THIS WEEK</div>
            <div class="subtitle">Perjalanan Musikmu di Minggu Ini</div>
            <div style="margin-top: 40px; font-size: 0.9rem; color: rgba(255,255,255,0.6); animation: tapPulse 2s ease-in-out infinite;">
                  Tap untuk lanjut 
            </div>
        </div>

        <!-- Slide 2: Total Minutes -->
        <div class="slide">
            <a href="index.html" class="home-button" title="Kembali ke Beranda">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                </svg>
            </a>
            <button class="mute-button" id="muteButton" onclick="event.stopPropagation(); toggleMute(event);" title="Mute/Unmute Audio">
                <svg id="muteIcon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <!-- Speaker icon (unmuted) -->
                    <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
                </svg>
            </button>
            <div class="title-large">TOTAL MENIT<br>MENDENGARKAN</div>
            <div class="stat-large" id="totalMinutes">8,427</div>
            <div class="stat-label" id="minutesComparison">menit musik</div>
            <div class="compliment-text" id="minutesCompliment"></div>
        </div>

        <!-- Slide 3: Total Songs -->
        <div class="slide">
            <a href="index.html" class="home-button" title="Kembali ke Beranda">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                </svg>
            </a>
            <button class="mute-button" id="muteButton" onclick="event.stopPropagation(); toggleMute(event);" title="Mute/Unmute Audio">
                <svg id="muteIcon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <!-- Speaker icon (unmuted) -->
                    <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
                </svg>
            </button>
            <div class="title-large">TOTAL LAGU<br>DIPUTAR</div>
            <div class="stat-large" id="totalSongs">1,248</div>
            <div class="stat-label">lagu berbeda</div>
            <div class="compliment-text" id="songsCompliment"></div>
        </div>

        <!-- Slide 4: Top Song Details -->
        <div class="slide">
            <a href="index.html" class="home-button" title="Kembali ke Beranda">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                </svg>
            </a>
            <button class="mute-button" id="muteButton" onclick="event.stopPropagation(); toggleMute(event);" title="Mute/Unmute Audio">
                <svg id="muteIcon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <!-- Speaker icon (unmuted) -->
                    <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
                </svg>
            </button>
            <!-- Vinyl Record Container -->
            <div class="vinyl-container" onclick="toggleVinyl(event)">
                <div class="vinyl-record" id="vinylRecord">
                    <div class="vinyl-grooves">
                        <svg viewBox="0 0 220 220" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="110" cy="110" r="105" fill="none" stroke="rgba(255,255,255,0.08)" stroke-width="0.5"/>
                            <circle cx="110" cy="110" r="100" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/>
                            <circle cx="110" cy="110" r="95" fill="none" stroke="rgba(255,255,255,0.08)" stroke-width="0.5"/>
                            <circle cx="110" cy="110" r="90" fill="none" stroke="rgba(255,255,255,0.12)" stroke-width="0.5"/>
                            <circle cx="110" cy="110" r="85" fill="none" stroke="rgba(255,255,255,0.08)" stroke-width="0.5"/>
                            <circle cx="110" cy="110" r="80" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/>
                            <circle cx="110" cy="110" r="75" fill="none" stroke="rgba(255,255,255,0.08)" stroke-width="0.5"/>
                            <circle cx="110" cy="110" r="70" fill="none" stroke="rgba(255,255,255,0.12)" stroke-width="0.5"/>
                            <circle cx="110" cy="110" r="65" fill="none" stroke="rgba(255,255,255,0.08)" stroke-width="0.5"/>
                            <circle cx="110" cy="110" r="60" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/>
                            <circle cx="110" cy="110" r="55" fill="none" stroke="rgba(255,255,255,0.08)" stroke-width="0.5"/>
                            <circle cx="110" cy="110" r="50" fill="none" stroke="rgba(255,255,255,0.12)" stroke-width="0.5"/>
                            <circle cx="110" cy="110" r="45" fill="none" stroke="rgba(255,255,255,0.08)" stroke-width="0.5"/>
                            <circle cx="110" cy="110" r="40" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/>
                        </svg>
                    </div>
                    <div class="vinyl-center">
                        <!-- Tempat untuk foto album - bisa diganti dengan gambar apapun -->
                        <img src="https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=400&h=400&fit=crop" alt="Album Cover" class="album-photo">
                    </div>
                </div>
            </div>
            <div class="title-large" style="margin-top: 20px;">LAGU TERATAS</div>
            <div class="subtitle" id="topSongName">Komala Pertama</div>
            <div class="stat-label" id="topSongPlays">127 kali diputar ‚Ä¢ Dewa 19</div>
            <div class="compliment-text" id="topSongCompliment"></div>
        </div>

        <!-- Slide 5: Top Artist Details with Album Art -->
        <div class="slide">
            <a href="index.html" class="home-button" title="Kembali ke Beranda">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                </svg>
            </a>
            <button class="mute-button" id="muteButton" onclick="event.stopPropagation(); toggleMute(event);" title="Mute/Unmute Audio">
                <svg id="muteIcon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <!-- Speaker icon (unmuted) -->
                    <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
                </svg>
            </button>
            <div class="title-large">ARTIS TERATAS</div>
            <div style="margin: 40px auto; width: 200px; height: 200px; border-radius: 12px; overflow: hidden; box-shadow: 0 20px 60px rgba(227, 27, 35, 0.4);">
                <img id="topArtistCover" src="https://images.unsplash.com/photo-1508700115892-45ecd05ae2ad?w=400&h=400&fit=crop" alt="Top Artist" style="width: 100%; height: 100%; object-fit: cover;">
            </div>
            <div class="subtitle" id="topArtistName">Dewa 19</div>
            <div class="stat-label" id="topArtistPlays">245 lagu diputar</div>
            <div class="compliment-text" id="topArtistCompliment"></div>
        </div>

        <!-- Slide 6: Top 5 Songs -->
        <div class="slide">
            <a href="index.html" class="home-button" title="Kembali ke Beranda">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                </svg>
            </a>
            <button class="mute-button" id="muteButton" onclick="event.stopPropagation(); toggleMute(event);" title="Mute/Unmute Audio">
                <svg id="muteIcon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <!-- Speaker icon (unmuted) -->
                    <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
                </svg>
            </button>
            <div class="title-large">5 LAGU TERATAS KAMU</div>
            <div class="top-list" id="topSongsList">
                <div class="top-item">
                    <div class="item-rank">1</div>
                    <img src="https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=200&h=200&fit=crop" alt="Komala Pertama" class="item-image">
                    <div class="item-info">
                        <div class="item-name">Komala Pertama</div>
                        <div class="item-stat">127 kali diputar</div>
                    </div>
                </div>
                <div class="top-item">
                    <div class="item-rank">2</div>
                    <img src="https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=200&h=200&fit=crop" alt="Separuh Nafas" class="item-image">
                    <div class="item-info">
                        <div class="item-name">Separuh Nafas</div>
                        <div class="item-stat">98 kali diputar</div>
                    </div>
                </div>
                <div class="top-item">
                    <div class="item-rank">3</div>
                    <img src="https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?w=200&h=200&fit=crop" alt="Risalah Hati" class="item-image">
                    <div class="item-info">
                        <div class="item-name">Risalah Hati</div>
                        <div class="item-stat">87 kali diputar</div>
                    </div>
                </div>
                <div class="top-item">
                    <div class="item-rank">4</div>
                    <img src="https://images.unsplash.com/photo-1487180144351-b8472da7d491?w=200&h=200&fit=crop" alt="Lagu Untuk Mama" class="item-image">
                    <div class="item-info">
                        <div class="item-name">Lagu Untuk Mama</div>
                        <div class="item-stat">76 kali diputar</div>
                    </div>
                </div>
                <div class="top-item">
                    <div class="item-rank">5</div>
                    <img src="https://images.unsplash.com/photo-1514320291840-2e0a9bf2a9ae?w=200&h=200&fit=crop" alt="Bertahan Untukmu" class="item-image">
                    <div class="item-info">
                        <div class="item-name">Bertahan Untukmu</div>
                        <div class="item-stat">68 kali diputar</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 7: Top 5 Artists -->
        <div class="slide">
            <a href="index.html" class="home-button" title="Kembali ke Beranda">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                </svg>
            </a>
            <button class="mute-button" id="muteButton" onclick="event.stopPropagation(); toggleMute(event);" title="Mute/Unmute Audio">
                <svg id="muteIcon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <!-- Speaker icon (unmuted) -->
                    <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
                </svg>
            </button>
            <div class="title-large">TOP 5 ARTIS KAMU</div>
            <div class="top-list" id="topArtistsList">
                <div class="top-item">
                    <div class="item-rank">1</div>
                    <img src="https://images.unsplash.com/photo-1508700115892-45ecd05ae2ad?w=200&h=200&fit=crop" alt="Dewa 19" class="item-image">
                    <div class="item-info">
                        <div class="item-name">Dewa 19</div>
                        <div class="item-stat">245 lagu diputar</div>
                    </div>
                </div>
                <div class="top-item">
                    <div class="item-rank">2</div>
                    <img src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=200&h=200&fit=crop" alt="Raisa" class="item-image">
                    <div class="item-info">
                        <div class="item-name">Raisa</div>
                        <div class="item-stat">198 lagu diputar</div>
                    </div>
                </div>
                <div class="top-item">
                    <div class="item-rank">3</div>
                    <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=200&h=200&fit=crop" alt="Tulus" class="item-image">
                    <div class="item-info">
                        <div class="item-name">Tulus</div>
                        <div class="item-stat">176 lagu diputar</div>
                    </div>
                </div>
                <div class="top-item">
                    <div class="item-rank">4</div>
                    <img src="https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=200&h=200&fit=crop" alt="Isyana Sarasvati" class="item-image">
                    <div class="item-info">
                        <div class="item-name">Isyana Sarasvati</div>
                        <div class="item-stat">154 lagu diputar</div>
                    </div>
                </div>
                <div class="top-item">
                    <div class="item-rank">5</div>
                    <img src="https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=200&h=200&fit=crop" alt="Sheila on 7" class="item-image">
                    <div class="item-info">
                        <div class="item-name">Sheila on 7</div>
                        <div class="item-stat">143 lagu diputar</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 8: Summary -->
        <div class="slide">
            <a href="index.html" class="home-button" title="Kembali ke Beranda">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                </svg>
            </a>
            <button class="mute-button" id="muteButton" onclick="event.stopPropagation(); toggleMute(event);" title="Mute/Unmute Audio">
                <svg id="muteIcon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <!-- Speaker icon (unmuted) -->
                    <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
                </svg>
            </button>
            <div class="title-large">RINGKASAN<br>MINGGU INI</div>
            <div class="summary-grid" style="max-width: 600px;">
                <div class="summary-card clickable" onclick="showOverlay('song')">
                    <div style="display: flex; flex-direction: column; align-items: center; gap: 15px;">
                        <img id="summaryTopSongCover" src="https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=400&h=400&fit=crop" alt="Top Song" style="width: 120px; height: 120px; border-radius: 12px; object-fit: cover; box-shadow: 0 8px 24px rgba(227, 27, 35, 0.4);">
                        <div class="summary-label" style="margin: 0;">Lagu Teratas</div>
                    </div>
                    <div style="font-size: 18px; font-weight: 600; margin-top: 15px; text-align: center;" id="summaryTopSong">Komala Pertama</div>
                    <div class="item-stat" style="text-align: center;" id="summaryTopSongPlays">127 kali diputar</div>
                </div>
                <div class="summary-card clickable" onclick="showOverlay('artist')">
                    <div style="display: flex; flex-direction: column; align-items: center; gap: 15px;">
                        <img id="summaryTopArtistCover" src="https://images.unsplash.com/photo-1508700115892-45ecd05ae2ad?w=400&h=400&fit=crop" alt="Top Artist" style="width: 120px; height: 120px; border-radius: 12px; object-fit: cover; box-shadow: 0 8px 24px rgba(227, 27, 35, 0.4);">
                        <div class="summary-label" style="margin: 0;">Artis Teratas</div>
                    </div>
                    <div style="font-size: 18px; font-weight: 600; margin-top: 15px; text-align: center;" id="summaryTopArtist">Dewa 19</div>
                    <div class="item-stat" style="text-align: center;" id="summaryTopArtistPlays">245 lagu diputar</div>
                </div>
            </div>
            <div class="summary-grid" style="margin-top: 30px;">
                <div class="summary-card clickable" onclick="showOverlay('minutes')">
                    <div class="summary-number" id="summaryMinutes">8.4K</div>
                    <div class="summary-label">Menit Mendengarkan</div>
                </div>
                <div class="summary-card clickable" onclick="showOverlay('songs')">
                    <div class="summary-number" id="summarySongs">1.2K</div>
                    <div class="summary-label">Total Lagu</div>
                </div>
            </div>
        </div>

        <!-- Slide 9: Ending -->
        <div class="slide">
            <a href="index.html" class="home-button" title="Kembali ke Beranda">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                </svg>
            </a>
            <button class="mute-button" id="muteButton" onclick="event.stopPropagation(); toggleMute(event);" title="Mute/Unmute Audio">
                <svg id="muteIcon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <!-- Speaker icon (unmuted) -->
                    <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
                </svg>
            </button>
            <div class="title-huge">VIDJE<br>RECORDS</div>
            <div class="subtitle">Terima kasih telah menjadi bagian dari Vidje Minggu ini!<br>Minggu Depan akan lebih seru lagi! üöÄ</div>
            <div style="margin-top: 30px;">
                <a href="index.html" class="btn-home">KEMBALI KE BERANDA</a>
                <button class="btn" onclick="share()">BAGIKAN</button>
                <button class="btn btn-secondary" onclick="restart()">ULANG LAGI</button>
            </div>
        </div>


    <!-- Overlay Modal -->
    <div class="overlay-modal" id="overlayModal">
        <div class="overlay-content">
            <button class="overlay-close" onclick="closeOverlay()">√ó</button>
            <img class="overlay-image" id="overlayImage" src="" alt="Detail">
            <div class="overlay-info">
                <div class="overlay-title" id="overlayTitle"></div>
                <div class="overlay-subtitle" id="overlaySubtitle"></div>
                <div class="overlay-stats" id="overlayStats"></div>
            </div>
        </div>
    </div>

    <!-- Background Music for Intro Slides (1-3) -->
    <audio id="introMusic" loop preload="metadata"></audio>
    </div>

    <!-- Firebase & Supabase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm';

        // ========================================
        // KONFIGURASI - SUDAH TERISI OTOMATIS
        // ========================================
        
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCEamepceiYZtcqlcRnRmFHe0smkGfu_A4",
            authDomain: "gochat-35172.firebaseapp.com",
            projectId: "gochat-35172",
            databaseURL: "https://gochat-35172-default-rtdb.asia-southeast1.firebasedatabase.app",
            storageBucket: "gochat-35172.firebasestorage.app",
            messagingSenderId: "206571646434",
            appId: "1:206571646434:web:c337d95ea3a6a121499dbb",
            measurementId: "G-XZ2K3PZ6ZK"
        };

        // Supabase Configuration
        const SUPABASE_URL = 'https://qkruoywwqdpkdjlajbpl.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFrcnVveXd3cWRwa2RqbGFqYnBsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk0NDY3OTcsImV4cCI6MjA4NTAyMjc5N30.6NQGI-d13SVih3VKOuSEvLYTeP5tf9QhEUyfi6mBEiA';

        // ========================================
        // INISIALISASI
        // ========================================
        
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);
        
        // Expose to window for intro music functionality
        window.supabase = supabase;

        // Global variables
        let currentUser = null;
        let userData = null;

        // ========================================
        // AUTO-LOAD DATA (TANPA LOGIN)
        // ========================================
        
        // Langsung load data saat halaman dibuka
        console.log('üéµ Loading Vidje Wrapped data...');
        
        // Cek auth state dari Firebase untuk mendapatkan user ID
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                currentUser = user;
                console.log('‚úÖ User logged in:', user.email);
                await loadUserData();
            } else {
                // Jika tidak ada user login, gunakan demo data atau user ID default
                console.log('‚ÑπÔ∏è No user logged in, using demo data');
                // Anda bisa menggunakan user ID default atau langsung load demo data
                userData = getDemoData();
                updateUI(userData);
            }
        });

        // ========================================
        // MYSTATS FUNCTION - BISA DIPANGGIL DI CONSOLE
        // ========================================
        
        window.myStats = async function() {
            if (!currentUser) {
                console.log('‚ÑπÔ∏è No user logged in. Showing demo data...');
                console.table(getDemoData());
                return;
            }
            
            const { data } = await supabase
                .from('listening_history')
                .select('*')
                .eq('user_id', currentUser.uid)
                .order('played_at', { ascending: false })
                .limit(10);
            
            console.log('üéµ Your last 10 songs:', data);
            console.table(data);
        };

        // ========================================
        // DATA LOADING FROM SUPABASE
        // ========================================
        
        async function loadUserData() {
            try {
                // Contoh query - sesuaikan dengan struktur tabel Anda
                // Asumsi: ada tabel 'listening_history' dengan kolom:
                // - user_id, song_name, artist_name, duration_minutes, played_at
                
                // Dinamis: ambil tahun sekarang
                const now = new Date();
                const currentYear = now.getFullYear();
                const startOfYear = `${currentYear}-01-01`;
                const midYear = `${currentYear}-06-30`;
                
                const { data, error } = await supabase
                    .from('listening_history')
                    .select('*')
                    .eq('user_id', currentUser.uid)
                    .gte('played_at', startOfYear) // Filter untuk half season (dinamis)
                    .lte('played_at', midYear);

                if (error) throw error;

                console.log('üìä Raw data from Supabase:', data);

                // Process data
                userData = processListeningData(data);
                
                console.log('‚úÖ Processed data:', userData);
                
                // Update UI with user data
                updateUI(userData);
                
            } catch (error) {
                console.error('‚ùå Error loading data:', error);
                
                // Fallback to demo data if there's an error
                userData = getDemoData();
                updateUI(userData);
            }
        }

        // ========================================
        // DATA PROCESSING
        // ========================================
        
        function processListeningData(rawData) {
            if (!rawData || rawData.length === 0) {
                console.log('‚ÑπÔ∏è No data found, using demo data');
                return getDemoData();
            }

            // Calculate total minutes
            const totalMinutes = Math.round(rawData.reduce((sum, item) => sum + (item.duration_minutes || 0), 0));
            
            // Calculate total songs
            const totalSongs = rawData.length;

            // Count plays per song
            const songCounts = {};
            rawData.forEach(item => {
                const key = `${item.song_name}|||${item.artist_name}`;
                if (!songCounts[key]) {
                    songCounts[key] = {
                        name: item.song_name,
                        artist: item.artist_name,
                        plays: 0,
                        cover: item.cover_url || null,
                        audioUrl: item.audio_url || null, // ‚Üê TAMBAHKAN COVER URL
                    };
                }
                songCounts[key].plays++;
            });

            // Get top songs
            const topSongs = Object.values(songCounts)
                .sort((a, b) => b.plays - a.plays)
                .slice(0, 5);

            // Count plays per artist
            const artistCounts = {};
            rawData.forEach(item => {
                if (!artistCounts[item.artist_name]) {
                    artistCounts[item.artist_name] = {
                        plays: 0,
                        cover: item.cover_url || null
                    };
                }
                artistCounts[item.artist_name].plays++;
            });

            // Get top artists
            const topArtists = Object.entries(artistCounts)
                .map(([name, data]) => ({ 
                    name, 
                    plays: data.plays,
                    cover: data.cover
                }))
                .sort((a, b) => b.plays - a.plays)
                .slice(0, 5);

            return {
                totalMinutes,
                totalSongs,
                topSongs,
                topArtists
            };
        }

        // Demo data fallback
        function getDemoData() {
            return {
                totalMinutes: 8423,
                totalSongs: 1247,
                topSongs: [
                    { name: 'Komala Pertama', artist: 'Dewa 19', plays: 127, cover: 'https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=400&h=400&fit=crop' },
                    { name: 'Kamulah Satu-satunya', artist: 'Dewa 19', plays: 98, cover: 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=400&h=400&fit=crop' },
                    { name: 'Kangen', artist: 'Dewa 19', plays: 87, cover: 'https://images.unsplash.com/photo-1514320291840-2e0a9bf2a9ae?w=400&h=400&fit=crop' },
                    { name: 'Separuh Nafas', artist: 'Dewa 19', plays: 76, cover: 'https://images.unsplash.com/photo-1487180144351-b8472da7d491?w=400&h=400&fit=crop' },
                    { name: 'Pupus', artist: 'Dewa 19', plays: 65, cover: 'https://images.unsplash.com/photo-1458560871784-56d23406c091?w=400&h=400&fit=crop' }
                ],
                topArtists: [
                    { name: 'Dewa 19', plays: 245 },
                    { name: 'Sheila On 7', plays: 187 },
                    { name: 'Peterpan', plays: 156 },
                    { name: 'Padi', plays: 134 },
                    { name: 'Ungu', plays: 112 }
                ]
            };
        }

        // ========================================
        // UI UPDATE
        // ========================================
        
        function updateUI(data) {
            console.log('üé® Updating UI with data:', data);
            
            // Update username di splash screen
            const displayName = currentUser?.displayName || currentUser?.email?.split('@')[0] || data.username || 'User';
            document.getElementById('splashUsername').textContent = displayName;
            
            // Update total minutes
            document.getElementById('totalMinutes').textContent = formatNumber(data.totalMinutes);
            const hours = Math.round(data.totalMinutes / 60);
            document.getElementById('minutesComparison').textContent = 
                `Itu setara dengan ${hours.toLocaleString('id-ID')} jam!`;

            // Update total songs
            document.getElementById('totalSongs').textContent = formatNumber(data.totalSongs);

            // Update top song (slide 6)
            if (data.topSongs.length > 0) {
                const topSong = data.topSongs[0];
                document.getElementById('topSongName').textContent = topSong.name;
                document.getElementById('topSongPlays').textContent = 
                    `${topSong.plays} kali diputar ‚Ä¢ ${topSong.artist}`;
                
                // Update album cover di vinyl record
                const albumPhoto = document.querySelector('.album-photo');
                if (albumPhoto && topSong.cover) {
                    albumPhoto.src = topSong.cover;
                    albumPhoto.alt = topSong.name;
                }
            }

            // Update top artist (slide 7)
            if (data.topArtists.length > 0) {
                const topArtist = data.topArtists[0];
                document.getElementById('topArtistName').textContent = topArtist.name;
                document.getElementById('topArtistPlays').textContent = 
                    `${topArtist.plays} lagu diputar`;
                
                // Update cover image
                const topArtistCover = document.getElementById('topArtistCover');
                if (topArtistCover) {
                    topArtistCover.src = topArtist.cover || 'https://images.unsplash.com/photo-1508700115892-45ecd05ae2ad?w=400&h=400&fit=crop';
                    topArtistCover.onerror = function() {
                        this.src = 'https://images.unsplash.com/photo-1508700115892-45ecd05ae2ad?w=400&h=400&fit=crop';
                    };
                }
            }

            // Update top songs list (slide 4)
            const topSongsList = document.getElementById('topSongsList');
            
            // Store top songs globally for auto-play
            window.currentTopSongs = data.topSongs;
            
            topSongsList.innerHTML = data.topSongs.map((song, index) => {
                const coverUrl = song.cover || 'https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=200&h=200&fit=crop';
                return `
                <div class="top-item clickable" data-song='${JSON.stringify(song).replace(/'/g, "&apos;")}'>
                    <div class="item-rank">${index + 1}</div>
                    <img src="${coverUrl}" alt="${song.name}" class="item-image" onerror="this.src='https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=200&h=200&fit=crop'">
                    <div class="item-info">
                        <div class="item-name">${song.name}</div>
                        <div class="item-stat">${song.artist} ‚Ä¢ ${song.plays} kali diputar</div>
                    </div>
                </div>
                `;
            }).join('');

            // Add click handlers to song items
            const songItems = document.querySelectorAll('#topSongsList .top-item');
            songItems.forEach((item, index) => {
                item.addEventListener('click', function(e) {
                    // Prevent slide navigation
                    e.stopPropagation();
                    
                    const songData = JSON.parse(this.getAttribute('data-song'));
                    
                    // Open song player overlay instead of mini player
                    openSongPlayer(songData, e);
                    
                    console.log(`üéµ User clicked song #${index + 1}:`, songData.name);
                });
            });

            // Auto-play removed - user will click to play via overlay
            // (Previously auto-played top song, but now we use overlay player)

            // Update top artists list (slide 5)
            const topArtistsList = document.getElementById('topArtistsList');
            topArtistsList.innerHTML = data.topArtists.map((artist, index) => `
                <div class="top-item clickable" data-artist-name="${artist.name}" data-artist-image="${artist.cover || `https://images.unsplash.com/photo-${1508700115892 + index}?w=200&h=200&fit=crop`}">
                    <div class="item-rank">${index + 1}</div>
                    <img src="${artist.cover || `https://images.unsplash.com/photo-${1508700115892 + index}?w=200&h=200&fit=crop`}" alt="${artist.name}" class="item-image" onerror="this.src='https://images.unsplash.com/photo-${1508700115892 + index}?w=200&h=200&fit=crop'">
                    <div class="item-info">
                        <div class="item-name">${artist.name}</div>
                        <div class="item-stat">${artist.plays} lagu diputar</div>
                    </div>
                </div>
            `).join('');

            // Add click handlers to artist items
            const artistItems = document.querySelectorAll('#topArtistsList .top-item');
            artistItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const artistName = this.getAttribute('data-artist-name');
                    const artistImage = this.getAttribute('data-artist-image');
                    showArtistOverlay(artistName, artistImage);
                });
            });

            // Update summary (slide 8)
            if (data.topSongs.length > 0) {
                document.getElementById('summaryTopSong').textContent = data.topSongs[0].name;
                document.getElementById('summaryTopSongPlays').textContent = 
                    `${data.topSongs[0].plays} kali diputar`;
                
                // Update cover image
                const summarySongCover = document.getElementById('summaryTopSongCover');
                if (summarySongCover) {
                    summarySongCover.src = data.topSongs[0].cover || 'https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=100&h=100&fit=crop';
                    summarySongCover.onerror = function() {
                        this.src = 'https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=100&h=100&fit=crop';
                    };
                }
            }
            if (data.topArtists.length > 0) {
                document.getElementById('summaryTopArtist').textContent = data.topArtists[0].name;
                document.getElementById('summaryTopArtistPlays').textContent = 
                    `${data.topArtists[0].plays} lagu diputar`;
                
                // Update cover image
                const summaryArtistCover = document.getElementById('summaryTopArtistCover');
                if (summaryArtistCover) {
                    summaryArtistCover.src = data.topArtists[0].cover || 'https://images.unsplash.com/photo-1508700115892-45ecd05ae2ad?w=100&h=100&fit=crop';
                    summaryArtistCover.onerror = function() {
                        this.src = 'https://images.unsplash.com/photo-1508700115892-45ecd05ae2ad?w=100&h=100&fit=crop';
                    };
                }
            }
            document.getElementById('summaryMinutes').textContent = formatNumber(data.totalMinutes);
            document.getElementById('summarySongs').textContent = formatNumber(data.totalSongs);

            console.log('‚úÖ UI updated successfully!');
        }

        function formatNumber(num) {
            if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toString();
        }

        console.log('‚úÖ Vidje Wrapped ready!');
        console.log('üí° Try typing: myStats() in console to see your stats');
    </script>

    <script>
        // ========================================
        // ===== RANDOM COMPLIMENTS SYSTEM =====
        
        const compliments = {
            totalMinutes: [
                "Wah, telinga kamu produktif banget!",
                "Musik adalah hidup kamu ya!",
                "Waktu yang berkualitas dengan musik!",
                "Sejati banget nih pecinta musik!",
                "Komitmen kamu ke musik luar biasa!",
                "Musik jadi teman setia kamu ya!",
                "Playlist kamu gak pernah berhenti!",
                "Hari tanpa musik? Gak kenal!",
                "Kuping kamu dimanjain banget!",
                "Musik adalah terapi kamu!",
                "Kamu ini DJ pribadi sendiri!",
                "Waktu well spent bareng musik!",
                "Soundtrack hidup kamu keren!",
                "Musik jadi vitamin kamu ya!",
                "Audio enthusiast sejati nih!"
            ],
            totalSongs: [
                "Eksplorer musik sejati!",
                "Selera musik kamu luas banget!",
                "Petualang musik yang hebat!",
                "Variety is your middle name!",
                "Open-minded ke musik baru!",
                "Kurator playlist profesional!",
                "Penikmat seni yang sejati!",
                "Treasure hunter di dunia musik!",
                "Koleksi musik kamu epic!",
                "Music library goals!",
                "Gak pernah bosen explore ya!",
                "Selera musik kamu kaya raya!",
                "Pencinta keberagaman musik!",
                "Playlist kamu museum hidup!",
                "Audiophile yang beneran!"
            ],
            topSong: [
                "Lagu favorit yang konsisten!",
                "Ini anthem kamu banget!",
                "On repeat terus ya!",
                "Gak bosen-bosen sama lagu ini!",
                "Lagu ini punya tempat spesial!",
                "Vibes-nya pas banget ya!",
                "Lagu andalan di segala suasana!",
                "Selalu balik ke lagu ini!",
                "Comfort song yang sempurna!",
                "Lagu yang ngerti kamu!",
                "Soundtrack momen penting kamu!",
                "Chemistry kamu sama lagu ini!",
                "Lagu wajib di playlist!",
                "Gak pernah skip lagu ini!",
                "Loyal listener goals!"
            ],
            topArtist: [
                "Superfan alert!",
                "Stan culture yang positif!",
                "Dedikasi ke artis favorit!",
                "True supporter nih!",
                "Artis ini lucky punya kamu!",
                "Loyalitas tingkat dewa!",
                "Supporting local talent!",
                "Karya mereka kamu hargai!",
                "Music taste on point!",
                "Kamu tau yang berkualitas!",
                "Real recognizes real!",
                "Penikmat karya sejati!",
                "Artis favorit yang tepat!",
                "Selera musik premium!",
                "Kamu punya taste!"
            ]
        };
        
        // Function to get random compliment
        function getRandomCompliment(category) {
            const array = compliments[category];
            if (!array || array.length === 0) return '';
            const randomIndex = Math.floor(Math.random() * array.length);
            return array[randomIndex];
        }
        
        // ===== END RANDOM COMPLIMENTS SYSTEM =====
        
        // ========================================
        // SPLASH SCREEN
        // ========================================
        
        
        
        window.startWrapped = function() {
            const splashScreen = document.getElementById('splashScreen');
            const introMusic = window.introMusicElement || document.getElementById('introMusic');
            
            console.log('üöÄ Starting wrapped...');
            console.log('üîç Intro music src:', introMusic ? introMusic.src : 'null');
            console.log('üîç Intro music ready:', window.introMusicUrl ? 'YES' : 'NO');
            
            // CRITICAL: Reset to first slide to prevent jump
            currentSlide = 0;
            console.log('üîÑ Reset currentSlide to:', currentSlide);
            
            // Hide splash screen
            splashScreen.classList.add('hidden');
            
            // Try to play intro music if it's loaded
            if (introMusic && introMusic.src && window.introMusicUrl) {
                console.log('üéµ Attempting to play intro music...');
                introMusic.volume = 0.5;
                
                introMusic.play()
                    .then(() => {
                        console.log('‚úÖ Intro music playing');
                        if (window.setIntroMusicPlaying) {
                            window.setIntroMusicPlaying(true);
                        }
                    })
                    .catch(err => {
                        console.warn('‚ö†Ô∏è Autoplay blocked:', err.message);
                        console.log('‚ÑπÔ∏è Music will start on slide 4 instead');
                    });
            } else {
                console.log('‚ÑπÔ∏è No intro music loaded - will start music on slide 4');
            }
            
            // Initialize first slide
            updateSlide();
        };
        // SLIDE NAVIGATION & MUSIC PLAYER
        // ========================================
        
        let currentSlide = 0;
        const slides = document.querySelectorAll('.container > .slide');
        const totalSlides = slides.length;
        const progressBar = document.getElementById('progressBar');
        
        console.log('üìã Slides found:', totalSlides);
        console.log('üéØ First slide:', slides[0]);
        console.log('üéØ Second slide:', slides[1]);

        // ========================================
        // INTRO MUSIC CONTROL (Slides 1-3)
        // ========================================
        const introMusic = document.getElementById('introMusic');
        let introMusicPlaying = false;
        let hasPassedIntroSection = false; // NEW: Track if user has passed intro slides

        // Auto-play intro music on first interaction
        function startIntroMusic() {
            // CRITICAL: Don't play intro music if user has already passed intro section
            if (hasPassedIntroSection) {
                console.log('üö´ User has passed intro section - intro music disabled');
                return;
            }
            
            if (!introMusicPlaying && currentSlide < 3) {
                introMusic.volume = 0.4; // Set to comfortable volume
                introMusic.play().then(() => {
                    introMusicPlaying = true;
                    console.log('üéµ Intro music started');
                }).catch(err => {
                    console.log('‚ö†Ô∏è Intro music autoplay blocked:', err.message);
                });
            }
        }

        // Fade out intro music smoothly
        function fadeOutIntroMusic() {
            console.log('üîá fadeOutIntroMusic called - current playing:', introMusicPlaying);
            
            if (!introMusicPlaying) {
                console.log('‚ö†Ô∏è Intro music already stopped');
                return;
            }
            
            // Clear any existing fade interval
            if (window.introFadeInterval) {
                clearInterval(window.introFadeInterval);
            }
            
            console.log('üéµ Starting fade out from volume:', introMusic.volume);
            
            window.introFadeInterval = setInterval(() => {
                if (introMusic.volume > 0.05) {
                    introMusic.volume = Math.max(0, introMusic.volume - 0.05);
                } else {
                    clearInterval(window.introFadeInterval);
                    introMusic.pause();
                    introMusic.currentTime = 0;
                    introMusic.volume = 0.5; // Reset volume for next play
                    introMusicPlaying = false;
                    
                    // Also update global state if exists
                    if (window.setIntroMusicPlaying) {
                        window.setIntroMusicPlaying(false);
                    }
                    
                    console.log('‚úÖ Intro music fully stopped and reset');
                }
            }, 50);
        }

        // ========================================
        // MUSIC PLAYER FUNCTIONALITY
        // ========================================
        
        let currentPlayingSong = null;
        let isPlaying = false;
        let miniPlayerVisible = true;
        window.userChangedSong = false; // Track if user manually changed song in slide 4
        const audioPlayer = document.getElementById('audioPlayer');
        const miniPlayer = document.getElementById('miniPlayer');
        const miniPlayerCover = document.getElementById('miniPlayerCover');
        const miniPlayerTitle = document.getElementById('miniPlayerTitle');
        const miniPlayerArtist = document.getElementById('miniPlayerArtist');
        const miniPlayerBtn = document.getElementById('miniPlayerBtn');
        const miniPlayerIcon = document.getElementById('miniPlayerIcon');
        const miniPlayerToggle = document.getElementById('miniPlayerToggle');
        const toggleIcon = document.getElementById('toggleIcon');

        // Play/Pause icons
        const playIcon = '<path d="M8 5v14l11-7z"/>';
        const pauseIcon = '<path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>';

        function playSong(song, autoPlay = false) {
            console.log('üéµ Playing song:', song);
            
            // CRITICAL: Ensure intro music is completely stopped before playing song
            if (introMusicPlaying || introMusic.volume > 0) {
                console.log('üõë Forcing intro music to stop before playing song');
                introMusic.pause();
                introMusic.currentTime = 0;
                introMusic.volume = 0.5;
                introMusicPlaying = false;
                
                // Clear any fade interval
                if (window.introFadeInterval) {
                    clearInterval(window.introFadeInterval);
                }
                
                // Also update global state if exists
                if (window.setIntroMusicPlaying) {
                    window.setIntroMusicPlaying(false);
                }
            }
            
            // Update current song
            currentPlayingSong = song;
            
            // Update mini player info
            miniPlayerCover.src = song.cover || 'https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=200&h=200&fit=crop';
            miniPlayerTitle.textContent = song.name;
            miniPlayerArtist.textContent = song.artist;
            
            // Show mini player and toggle button
            miniPlayer.classList.add('active');
            miniPlayer.classList.remove('hidden');
            miniPlayerToggle.classList.add('show');
            miniPlayerVisible = true;
            
            // Update playing state in UI
            document.querySelectorAll('.top-item').forEach(item => {
                item.classList.remove('playing');
            });
            
            // Find and highlight current playing song
            const songItems = document.querySelectorAll('#topSongsList .top-item');
            songItems.forEach(item => {
                const songName = item.querySelector('.item-name')?.textContent;
                if (songName === song.name) {
                    item.classList.add('playing');
                }
            });
            
            // Actually play audio
            // Use song.audioUrl from database, or use a preview URL for demo
            const audioUrl = song.audioUrl || song.audio_url || 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3';
            
            audioPlayer.src = audioUrl;
            audioPlayer.load();
            
            if (autoPlay || !isPlaying) {
                isPlaying = true;
                miniPlayerIcon.innerHTML = pauseIcon;
                
                // Play audio with error handling
                audioPlayer.play().then(() => {
                    console.log('‚ñ∂Ô∏è Audio playing successfully');
                    // Clear pending autoplay if successful
                    window.pendingAutoplaySong = null;
                }).catch(err => {
                    console.warn('‚ö†Ô∏è Audio autoplay blocked:', err.message);
                    console.log('üí° Mobile browsers block autoplay - waiting for user interaction');
                    
                    // MOBILE FIX: Reset play state since autoplay failed
                    isPlaying = false;
                    miniPlayerIcon.innerHTML = playIcon;
                    
                    // Keep song ready to play on next user interaction
                    window.pendingAutoplaySong = song;
                    
                    // Show visual hint that song is ready
                    console.log('üëÜ Tap anywhere to start playing');
                });
            }
        }

        function toggleMiniPlayer() {
            isPlaying = !isPlaying;
            miniPlayerIcon.innerHTML = isPlaying ? pauseIcon : playIcon;
            
            if (isPlaying) {
                console.log('‚ñ∂Ô∏è Playing');
                audioPlayer.play().catch(err => {
                    console.log('‚ö†Ô∏è Audio play failed:', err.message);
                });
            } else {
                console.log('‚è∏Ô∏è Paused');
                audioPlayer.pause();
            }
        }

        function toggleMiniPlayerVisibility() {
            miniPlayerVisible = !miniPlayerVisible;
            
            if (miniPlayerVisible) {
                // Show mini player - slide in from left
                miniPlayer.classList.add('active');
                miniPlayer.classList.remove('hidden');
                toggleIcon.innerHTML = '<path d="M15 18l-6-6 6-6"/>';  // < icon (hide)
            } else {
                // Hide mini player - slide out to left
                miniPlayer.classList.remove('active');
                miniPlayer.classList.add('hidden');
                toggleIcon.innerHTML = '<path d="M9 18l6-6-6-6"/>';  // > icon (show)
            }
        }


        function hideMiniPlayer() {
            miniPlayer.classList.remove('active');
            miniPlayer.classList.add('hidden');
            miniPlayerToggle.classList.remove('show');
            isPlaying = false;
            miniPlayerIcon.innerHTML = playIcon;
            window.currentOverlaySong = null;
            miniPlayerVisible = false;
            
            // Stop audio
            audioPlayer.pause();
            audioPlayer.currentTime = 0;
            
            // Remove all playing states
            document.querySelectorAll('.top-item').forEach(item => {
                item.classList.remove('playing');
            });
        }

        // Audio player event listeners
        audioPlayer.addEventListener('ended', () => {
            isPlaying = false;
            miniPlayerIcon.innerHTML = playIcon;
            console.log('üéµ Song ended');
        });

        audioPlayer.addEventListener('pause', () => {
            if (!audioPlayer.ended) {
                isPlaying = false;
                miniPlayerIcon.innerHTML = playIcon;
            }
        });

        audioPlayer.addEventListener('play', () => {
            isPlaying = true;
            miniPlayerIcon.innerHTML = pauseIcon;
        });

        // Vinyl Record Control
        function toggleVinyl(e) {
            e.stopPropagation(); // Prevent slide navigation
            const vinyl = document.getElementById('vinylRecord');
            
            if (vinyl.classList.contains('paused')) {
                vinyl.classList.remove('paused');
            } else {
                vinyl.classList.add('paused');
            }
        }

        // Create floating particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            
            if (!particlesContainer) {
                console.error('‚ùå Particles container not found!');
                return;
            }
            
            // Detect mobile devices
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || window.innerWidth < 768;
            
            // Reduce particles on mobile for better performance
            const particleCount = isMobile ? 15 : 30;
            
            console.log(`üé® Creating ${particleCount} particles (${isMobile ? 'mobile' : 'desktop'} mode)`);
            console.log('üì¶ Particles container:', particlesContainer);
            console.log('üìê Container dimensions:', particlesContainer.offsetWidth, 'x', particlesContainer.offsetHeight);
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
                
                // Force hardware acceleration for better mobile performance
                particle.style.willChange = 'transform, opacity';
                particle.style.transform = 'translateZ(0)';
                
                // MOBILE FIX: Force visibility
                particle.style.display = 'block';
                particle.style.position = 'absolute';
                
                particlesContainer.appendChild(particle);
            }
            
            // Debug: Check if particles were created
            const createdParticles = particlesContainer.querySelectorAll('.particle');
            console.log('‚úÖ Created', createdParticles.length, 'particles');
            
            // MOBILE FIX: Ensure container is visible
            particlesContainer.style.display = 'block';
            particlesContainer.style.visibility = 'visible';
            particlesContainer.style.opacity = '1';
            
            console.log('‚úÖ Particles container visibility set');
        }

        // Create particles for splash screen
        function createSplashParticles() {
            const splashParticles = document.getElementById('splashParticles');
            if (!splashParticles) {
                console.warn('‚ö†Ô∏è Splash particles container not found');
                return;
            }
            
            // Detect mobile devices
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || window.innerWidth < 768;
            
            // Reduce particles on mobile for better performance
            const particleCount = isMobile ? 10 : 20;
            
            console.log(`‚ú® Creating ${particleCount} splash particles (${isMobile ? 'mobile' : 'desktop'} mode)`);
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 10 + 's';
                particle.style.animationDuration = (Math.random() * 8 + 10) + 's';
                
                // Force hardware acceleration for better mobile performance
                particle.style.willChange = 'transform, opacity';
                particle.style.transform = 'translateZ(0)';
                
                // MOBILE FIX: Force visibility
                particle.style.display = 'block';
                particle.style.position = 'absolute';
                
                splashParticles.appendChild(particle);
            }
            
            // Debug: Check if particles were created
            const createdParticles = splashParticles.querySelectorAll('.particle');
            console.log('‚úÖ Created', createdParticles.length, 'splash particles');
            
            // MOBILE FIX: Ensure container is visible
            splashParticles.style.display = 'block';
            splashParticles.style.visibility = 'visible';
            splashParticles.style.opacity = '1';
        }

        // Initialize splash particles
        createSplashParticles();

        function updateSlide() {
            console.log('üîÑ updateSlide called - currentSlide:', currentSlide);
            console.log('üìä Total slides:', totalSlides);
            console.log('üéØ Will show slide at index:', currentSlide);
            
            // Hide all slides
            slides.forEach(slide => slide.classList.remove('active'));
            
            // Show current slide
            slides[currentSlide].classList.add('active');
            
            console.log('‚úÖ Activated slide:', slides[currentSlide]);
            
            // Update progress bar
            const progress = ((currentSlide + 1) / totalSlides) * 100;
            progressBar.style.width = progress + '%';

            // Intro music control (slides 0-2 = slides 1-3 in UI)
            if (currentSlide >= 0 && currentSlide <= 2) {
                // Only try to start intro music if user hasn't passed intro section yet
                if (!hasPassedIntroSection && !introMusicPlaying) {
                    startIntroMusic();
                }
            } else if (currentSlide === 3) {
                // Slide 4: Top Song Details - Fade out intro music, auto-play top song
                console.log('üéØ SLIDE 4: User reached main content - intro section passed');
                
                // CRITICAL: Mark that user has passed intro section
                hasPassedIntroSection = true;
                
                // CRITICAL: Force stop intro music immediately
                fadeOutIntroMusic();
                
                const topSong = window.currentTopSongs?.[0];
                if (topSong && !currentPlayingSong) {
                    console.log('üéµ Slide 4: Auto-playing top song #1');
                    
                    // MOBILE FIX: Try to play immediately, with fallback
                    const playWithFallback = () => {
                        playSong(topSong, true);
                        window.userChangedSong = false;
                    };
                    
                    // Try immediate play (works on desktop and some mobile)
                    setTimeout(playWithFallback, 1200);
                    
                    // Store for manual play if autoplay blocked
                    window.pendingAutoplaySong = topSong;
                } else if (topSong && currentPlayingSong) {
                    console.log('üéµ Slide 4: Song already playing, continuing...');
                }
                
                console.log('‚úÖ hasPassedIntroSection = true - intro music will never play again');
            } else if (currentSlide === 4) {
                // Slide 5: Top Artist Details - Continue playing
                console.log('üéµ Slide 5: Top Artist continues playing');
            } else if (currentSlide === 5) {
                // Slide 6: Top 5 Songs - Continue playing
                console.log('üéµ Slide 6: Top 5 Songs continues playing');
            } else if (currentSlide === 6) {
                // Slide 7: Top 5 Artists - Continue playing  
                console.log('üéµ Slide 7: Top 5 Artists continues playing');
            } 
            // === INTRO MUSIC DI SLIDE 9 (ENDING) - ONLY IF USER HASN'T PASSED INTRO ===
            else if (currentSlide === 8) {
                // CRITICAL: Don't bring back intro music if user already passed intro section
                if (hasPassedIntroSection) {
                    console.log('üéµ Slide 9: Ending - continuing with current song (no intro music replay)');
                    // Just let current song continue playing
                    return;
                }
                
                // Slide 9: Ending - fade out song music, fade in intro music
                console.log('üéµ Slide 9: Ending - bringing back intro music');
                
                // Get intro music element
                const introMusicEl = document.getElementById('introMusic');
                console.log('üîç Intro music element:', introMusicEl);
                console.log('üîç Intro music src:', introMusicEl?.src);
                console.log('üîç Is muted?', isMuted);
                
                // Fade out current song
                if (audioPlayer && !audioPlayer.paused) {
                    const fadeOutSong = setInterval(() => {
                        if (audioPlayer.volume > 0.05) {
                            audioPlayer.volume = Math.max(0, audioPlayer.volume - 0.05);
                        } else {
                            clearInterval(fadeOutSong);
                            audioPlayer.pause();
                            audioPlayer.volume = 1;
                            
                            // Hide mini player
                            hideMiniPlayer();
                            
                            // Fade in intro music DIRECTLY
                            if (introMusicEl && introMusicEl.src) {
                                setTimeout(() => {
                                    console.log('üéµ Starting intro music fade in...');
                                    
                                    // CRITICAL: Unmute intro music if globally muted
                                    introMusicEl.muted = false;
                                    
                                    introMusicEl.volume = 0;
                                    introMusicEl.currentTime = 0; // Reset to start
                                    introMusicEl.loop = true; // Loop the intro music
                                    
                                    introMusicEl.play()
                                        .then(() => {
                                            console.log('‚úÖ Intro music playing');
                                            // Fade in gradually
                                            const fadeIn = setInterval(() => {
                                                if (introMusicEl.volume < 0.45) {
                                                    introMusicEl.volume = Math.min(0.5, introMusicEl.volume + 0.05);
                                                } else {
                                                    introMusicEl.volume = 0.5;
                                                    clearInterval(fadeIn);
                                                    console.log('üîä Intro music faded in complete - Volume:', introMusicEl.volume);
                                                }
                                            }, 50);
                                        })
                                        .catch(err => {
                                            console.error('‚ùå Failed to play intro music:', err);
                                            alert('Cannot play intro music. Check console for details.');
                                        });
                                }, 300);
                            } else {
                                console.warn('‚ö†Ô∏è Intro music not loaded. Src:', introMusicEl?.src);
                                alert('Intro music not loaded yet. Please wait and try again.');
                            }
                        }
                    }, 50);
                } else {
                    // If no song playing, just fade in intro music
                    hideMiniPlayer();
                    
                    // Fade in intro music DIRECTLY
                    if (introMusicEl && introMusicEl.src) {
                        setTimeout(() => {
                            console.log('üéµ Starting intro music fade in (no song playing)...');
                            
                            // CRITICAL: Unmute intro music if globally muted
                            introMusicEl.muted = false;
                            
                            introMusicEl.volume = 0;
                            introMusicEl.currentTime = 0; // Reset to start
                            introMusicEl.loop = true; // Loop the intro music
                            
                            introMusicEl.play()
                                .then(() => {
                                    console.log('‚úÖ Intro music playing');
                                    // Fade in gradually
                                    const fadeIn = setInterval(() => {
                                        if (introMusicEl.volume < 0.45) {
                                            introMusicEl.volume = Math.min(0.5, introMusicEl.volume + 0.05);
                                        } else {
                                            introMusicEl.volume = 0.5;
                                            clearInterval(fadeIn);
                                            console.log('üîä Intro music faded in complete - Volume:', introMusicEl.volume);
                                        }
                                    }, 50);
                                })
                                .catch(err => {
                                    console.error('‚ùå Failed to play intro music:', err);
                                    alert('Cannot play intro music. Check console for details.');
                                });
                        }, 300);
                    } else {
                        console.warn('‚ö†Ô∏è Intro music not loaded. Src:', introMusicEl?.src);
                        alert('Intro music not loaded yet. Please wait and try again.');
                    }
                }
            }
            else if (currentSlide > 7 && currentSlide !== 8) {
                // Hide mini player after slide 8 (but not on slide 9)
                hideMiniPlayer();
            }
        }

        function nextSlide() {
            if (currentSlide < totalSlides - 1) {
                currentSlide++;
                updateSlide();
                hapticFeedback();
            }
        }

        function prevSlide() {
            if (currentSlide > 0) {
                currentSlide--;
                updateSlide();
                hapticFeedback();
            }
        }

        function restart() {
            currentSlide = 0;
            updateSlide();
        }

        // Overlay Modal Functions
        function showOverlay(type) {
            const modal = document.getElementById('overlayModal');
            const overlayContent = modal.querySelector('.overlay-content');
            const image = document.getElementById('overlayImage');
            const title = document.getElementById('overlayTitle');
            const subtitle = document.getElementById('overlaySubtitle');
            const stats = document.getElementById('overlayStats');
            
            // Prevent slide navigation when clicking overlay
            event.stopPropagation();
            
            // Reset data-only class
            overlayContent.classList.remove('data-only');
            
            switch(type) {
                case 'song':
                    image.src = document.getElementById('summaryTopSongCover').src;
                    title.textContent = document.getElementById('summaryTopSong').textContent;
                    subtitle.textContent = 'Lagu Teratas';
                    stats.textContent = document.getElementById('summaryTopSongPlays').textContent;
                    break;
                    
                case 'artist':
                    image.src = document.getElementById('summaryTopArtistCover').src;
                    title.textContent = document.getElementById('summaryTopArtist').textContent;
                    subtitle.textContent = 'Artis Teratas';
                    stats.textContent = document.getElementById('summaryTopArtistPlays').textContent;
                    break;
                    
                case 'minutes':
                    // Data-only mode (no image)
                    overlayContent.classList.add('data-only');
                    title.textContent = document.getElementById('summaryMinutes').textContent;
                    subtitle.textContent = 'Menit Mendengarkan';
                    stats.textContent = 'Total waktu yang kamu habiskan untuk menikmati musik di Vidje Records';
                    break;
                    
                case 'songs':
                    // Data-only mode (no image)
                    overlayContent.classList.add('data-only');
                    title.textContent = document.getElementById('summarySongs').textContent;
                    subtitle.textContent = 'Total Lagu';
                    stats.textContent = 'Total lagu berbeda yang sudah kamu dengarkan di Vidje Records';
                    break;
            }
            
            modal.classList.add('active');
        }
        
        function closeOverlay() {
            const modal = document.getElementById('overlayModal');
            const overlayContent = modal.querySelector('.overlay-content');
            modal.classList.remove('active');
            overlayContent.classList.remove('data-only');
        }
        
        // Close overlay when clicking outside
        document.addEventListener('click', (e) => {
            const modal = document.getElementById('overlayModal');
            if (e.target === modal) {
                closeOverlay();
            }
        });
        // Keyboard support for overlay
        document.addEventListener('keydown', (e) => {
            const modal = document.getElementById('overlayModal');
            if (e.key === 'Escape' && modal.classList.contains('active')) {
                closeOverlay();
            }
        });


        function share() {
            if (navigator.share) {
                navigator.share({
                    title: 'Vidje Records - Half Season Wrapped',
                    text: 'Lihat Vidje Wrapped paruh pertama tahun ini! üî•',
                    url: window.location.href
                }).catch(err => {
                    console.log('Share cancelled');
                });
            } else {
                alert('Vidje Wrapped siap dibagikan! üöÄ\n\nSalin link ini untuk berbagi.');
            }
        }

        // Add haptic feedback for mobile (if available)
        function hapticFeedback() {
            if (navigator.vibrate) {
                navigator.vibrate(10);
            }
        }

        // Click/Tap on slide to advance - Left side = prev, Right side = next
        document.addEventListener('click', (e) => {
            // CRITICAL: Ignore clicks on splash screen or splash button
            const splashScreen = document.getElementById('splashScreen');
            if (e.target.closest('.splash-screen') || e.target.closest('.splash-btn') || 
                !splashScreen.classList.contains('hidden')) {
                console.log('üö´ Click on splash screen - ignored');
                return;
            }
            
            // MOBILE FIX: Try to play pending song if autoplay was blocked
            if (currentSlide === 3 && window.pendingAutoplaySong && !currentPlayingSong) {
                console.log('üì± Mobile: Attempting to play pending song after click');
                playSong(window.pendingAutoplaySong, true);
                window.pendingAutoplaySong = null; // Clear pending
                return; // Don't navigate, just play
            }
            
            // Start intro music on first user interaction
            if (currentSlide <= 2 && !introMusicPlaying && !hasPassedIntroSection) {
                startIntroMusic();
            }
            
            // Don't advance if clicking on buttons, scrollable areas, vinyl, overlay, or clickable cards
            if (e.target.closest('.btn') || e.target.closest('.top-list') || e.target.closest('.vinyl-container') || 
                e.target.closest('.overlay-modal') || e.target.closest('.summary-card.clickable')) {
                return;
            }
            
            // Get click position relative to window width
            const clickX = e.clientX;
            const windowWidth = window.innerWidth;
            
            // Left half = previous, Right half = next
            if (clickX < windowWidth / 2) {
                prevSlide();
            } else {
                nextSlide();
            }
        });

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            // Start intro music on first user interaction (only if not passed intro section)
            if (currentSlide <= 2 && !introMusicPlaying && !hasPassedIntroSection) {
                startIntroMusic();
            }
            
            if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextSlide();
            } else if (e.key === 'ArrowLeft') {
                e.preventDefault();
                prevSlide();
            } else if (e.key === 'Home') {
                e.preventDefault();
                currentSlide = 0;
                updateSlide();
            } else if (e.key === 'End') {
                e.preventDefault();
                currentSlide = totalSlides - 1;
                updateSlide();
            }
        });

        // Touch swipe with better detection
        let touchStartX = 0;
        let touchEndX = 0;
        let touchStartY = 0;
        let touchEndY = 0;

        document.addEventListener('touchstart', (e) => {
            // CRITICAL: Ignore touches on splash screen
            const splashScreen = document.getElementById('splashScreen');
            if (e.target.closest('.splash-screen') || !splashScreen.classList.contains('hidden')) {
                console.log('üö´ Touch on splash screen - ignored');
                return;
            }
            
            // Start intro music on first user interaction (only if not passed intro section)
            if (currentSlide <= 2 && !introMusicPlaying && !hasPassedIntroSection) {
                startIntroMusic();
            }
            
            // Don't handle swipe on scrollable areas
            if (e.target.closest('.top-list')) {
                return;
            }
            touchStartX = e.changedTouches[0].screenX;
            touchStartY = e.changedTouches[0].screenY;
        });

        document.addEventListener('touchend', (e) => {
            // CRITICAL: Ignore touches on splash screen
            const splashScreen = document.getElementById('splashScreen');
            if (e.target.closest('.splash-screen') || !splashScreen.classList.contains('hidden')) {
                console.log('üö´ Touch end on splash screen - ignored');
                return;
            }
            
            // MOBILE FIX: Try to play pending song if on slide 4 and autoplay was blocked
            if (currentSlide === 3 && window.pendingAutoplaySong && !currentPlayingSong) {
                console.log('üì± Mobile: Attempting to play pending song after touch interaction');
                playSong(window.pendingAutoplaySong, true);
                window.pendingAutoplaySong = null; // Clear pending
            }
            
            // Don't handle swipe on scrollable areas
            if (e.target.closest('.top-list')) {
                return;
            }
            touchEndX = e.changedTouches[0].screenX;
            touchEndY = e.changedTouches[0].screenY;
            
            const deltaX = touchStartX - touchEndX;
            const deltaY = Math.abs(touchStartY - touchEndY);
            
            // Only trigger if horizontal swipe is greater than vertical
            if (Math.abs(deltaX) > deltaY && Math.abs(deltaX) > 50) {
                if (deltaX > 0) {
                    nextSlide();
                } else {
                    prevSlide();
                }
            }
        });

        // Mouse wheel navigation with debounce
        let scrollTimeout;
        document.addEventListener('wheel', (e) => {
            clearTimeout(scrollTimeout);
            scrollTimeout = setTimeout(() => {
                if (e.deltaY > 0) {
                    nextSlide();
                } else if (e.deltaY < 0) {
                    prevSlide();
                }
            }, 150);
        }, { passive: true });

        // Add touch feedback for buttons
        document.querySelectorAll('.btn').forEach(btn => {
            btn.addEventListener('touchstart', function() {
                this.style.transform = 'scale(0.95)';
            });
            btn.addEventListener('touchend', function() {
                this.style.transform = '';
            });
        });


        // ========================================
        // ARTIST OVERLAY FUNCTIONALITY
        // ========================================
        
        const artistOverlay = document.getElementById('artistOverlay');
        const artistOverlayTitle = document.getElementById('artistOverlayTitle');
        const artistOverlaySubtitle = document.getElementById('artistOverlaySubtitle');
        const artistOverlayImage = document.getElementById('artistOverlayImage');
        const artistOverlaySongs = document.getElementById('artistOverlaySongs');

        async function showArtistOverlay(artistName, artistImage) {
            console.log('üé® Opening overlay for artist:', artistName);
            
            // Update overlay header
            artistOverlayTitle.textContent = artistName;
            artistOverlayImage.src = artistImage || 'https://images.unsplash.com/photo-1508700115892-45ecd05ae2ad?w=200&h=200&fit=crop';
            artistOverlaySubtitle.textContent = 'Top Songs';
            
            // Show loading state
            artistOverlaySongs.innerHTML = `
                <div style="text-align: center; padding: 40px; color: rgba(255,255,255,0.6);">
                    <div class="spinner" style="margin: 0 auto;"></div>
                    <p style="margin-top: 20px;">Loading songs...</p>
                </div>
            `;
            
            // Show overlay
            artistOverlay.classList.add('active');
            
            try {
                // Fetch top songs for this artist from database
                if (window.vidjeTracking) {
                    const artistSongs = await window.vidjeTracking.getTopSongsByArtist(artistName, 10);
                    console.log('üéµ Artist songs:', artistSongs);
                    
                    // Debug: Log cover URLs
                    if (artistSongs.length > 0) {
                        console.log('üñºÔ∏è Cover URLs received:');
                        artistSongs.forEach((song, i) => {
                            console.log(`  ${i + 1}. ${song.song_name}: ${song.cover_url || 'NO COVER'}`);
                        });
                    }
                    
                    if (artistSongs && artistSongs.length > 0) {
                        // Populate songs
                        artistOverlaySongs.innerHTML = artistSongs.map((song, index) => {
                            const coverUrl = song.cover_url || 'https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=200&h=200&fit=crop';
                            return `
                            <div class="artist-song-item" data-song='${JSON.stringify({
                                name: song.song_name,
                                artist: artistName,
                                audioUrl: song.audio_url,
                                cover: coverUrl,
                                plays: song.play_count
                            }).replace(/'/g, "&apos;")}'>
                                <div class="artist-song-rank">${index + 1}</div>
                                <img src="${coverUrl}" 
                                     alt="${song.song_name}" 
                                     class="artist-song-cover"
                                     onerror="this.src='https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=200&h=200&fit=crop'">
                                <div class="artist-song-info">
                                    <div class="artist-song-name">${song.song_name}</div>
                                </div>
                                <button class="artist-song-play-btn">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M8 5v14l11-7z"/>
                                    </svg>
                                </button>
                            </div>
                        `}).join('');
                        
                        // Add click handlers to song items
                        const songItems = document.querySelectorAll('.artist-song-item');
                        songItems.forEach(item => {
                            item.addEventListener('click', function(e) {
                                e.stopPropagation();
                                const songData = JSON.parse(this.getAttribute('data-song'));
                                playSong(songData, true);
                                
                                // Update playing state
                                document.querySelectorAll('.artist-song-item').forEach(el => {
                                    el.classList.remove('playing');
                                });
                                this.classList.add('playing');
                                
                                console.log('üéµ Playing artist song:', songData.name);
                            });
                        });
                    } else {
                        artistOverlaySongs.innerHTML = `
                            <div style="text-align: center; padding: 40px; color: rgba(255,255,255,0.6);">
                                <p>No songs found for this artist</p>
                            </div>
                        `;
                    }
                } else {
                    // Fallback: Show demo data
                    console.warn('‚ö†Ô∏è Vidje Tracking not available, using demo data');
                    artistOverlaySongs.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: rgba(255,255,255,0.6);">
                            <p>Connect to database to see artist songs</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('‚ùå Error loading artist songs:', error);
                artistOverlaySongs.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: rgba(255,255,255,0.6);">
                        <p>Error loading songs. Please try again.</p>
                    </div>
                `;
            }
        }

        function closeArtistOverlay() {
            artistOverlay.classList.remove('active');
            console.log('üé® Closed artist overlay');
        }

        // Close overlay when clicking outside
        artistOverlay.addEventListener('click', function(e) {
            if (e.target === artistOverlay) {
                closeArtistOverlay();
            }
        });

        // Prevent overlay content clicks from triggering slide navigation
        const artistOverlayContent = document.querySelector('.artist-overlay-content');
        if (artistOverlayContent) {
            artistOverlayContent.addEventListener('click', function(e) {
                e.stopPropagation();
            });
        }

        
        // ========================================
        // FIREBASE AUTH SUPPORT (for compatibility with index.html)
        // ========================================
        
        // Check if Firebase is available (might be loaded from another page)
        let firebaseAuth = null;
        
        // Try to get auth from window (if coming from index.html)
        if (typeof auth !== 'undefined') {
            firebaseAuth = auth;
            console.log('‚úÖ Firebase Auth detected from global scope');
        } else if (typeof window.auth !== 'undefined') {
            firebaseAuth = window.auth;
            console.log('‚úÖ Firebase Auth detected from window.auth');
        } else {
            console.log('‚ÑπÔ∏è  No Firebase Auth detected (using anonymous mode)');
        }
        
        // Helper: Get current user info
        window.getCurrentUserInfo = function() {
            if (firebaseAuth && firebaseAuth.currentUser) {
                return {
                    uid: firebaseAuth.currentUser.uid,
                    email: firebaseAuth.currentUser.email,
                    displayName: firebaseAuth.currentUser.displayName
                };
            }
            return null;
        };
        
// ========================================
        // VIDJE TRACKING: LOAD REAL DATA
        // ========================================
        
        async function loadWrappedData() {
            console.log('üéµ Loading Vidje Wrapped data from database...');
            
            // Check if tracking is available
            if (!window.vidjeTracking) {
                console.error('‚ùå Vidje Tracking not loaded!');
                showErrorMessage('Tracking system not loaded. Please refresh the page.');
                return;
            }
            
            // Check user
            const userInfo = window.getCurrentUserInfo();
            const userId = window.vidjeTracking.getCurrentUserId();
            console.log('üë§ Current user:', userInfo || { uid: userId });
            
            try {
                // Show loading indicator
                showLoadingMessage('Loading your music journey...');
                
                // Fetch all data in parallel
                const [stats, topSongs, topArtists] = await Promise.all([
                    window.vidjeTracking.getListeningStats(),
                    window.vidjeTracking.getTopSongs(10),
                    window.vidjeTracking.getTopArtists(5)
                ]);
                
                console.log('üìä Stats:', stats);
                console.log('üéµ Top Songs:', topSongs);
                console.log('üé§ Top Artists:', topArtists);
                
                // Check if we have data
                if (!stats || stats.totalPlays === 0) {
                    console.warn('‚ö†Ô∏è  No listening data found');
                    showNoDataMessage();
                    return;
                }
                
                // Hide loading, update UI
                hideMessages();
                updateWrappedUI(stats, topSongs, topArtists);
                
                console.log('‚úÖ Wrapped data loaded successfully!');
                
            } catch (error) {
                console.error('‚ùå Failed to load wrapped data:', error);
                showErrorMessage('Failed to load data. Please try again or check console for details.');
            }
        }
        
        // Helper functions for messages
        function showLoadingMessage(message) {
            const overlay = createMessageOverlay(message, 'loading');
            document.body.appendChild(overlay);
        }
        
        function showNoDataMessage() {
            const message = `
                <div style="text-align: center; padding: 40px;">
                    <h2 style="font-size: 2em; margin-bottom: 20px;">No Data Yet!</h2>
                    <p style="font-size: 1.2em; margin-bottom: 30px;">
                        You haven't listened to any songs yet.
                    </p>
                    <p style="font-size: 1em; opacity: 0.8;">
                        Go to <strong>index.html</strong>, login, and play some music!<br>
                        Then come back here to see your Wrapped.
                    </p>
                </div>
            `;
            const overlay = createMessageOverlay(message, 'no-data');
            document.body.appendChild(overlay);
        }
        
        function showErrorMessage(message) {
            const errorMsg = `
                <div style="text-align: center; padding: 40px;">
                    <h2 style="font-size: 2em; margin-bottom: 20px; color: var(--red-primary);">Error</h2>
                    <p style="font-size: 1.2em; margin-bottom: 30px;">${message}</p>
                    <button onclick="location.reload()" style="
                        background: var(--red-primary);
                        color: white;
                        border: none;
                        padding: 15px 40px;
                        font-size: 1.1em;
                        border-radius: 50px;
                        cursor: pointer;
                        font-weight: bold;
                    ">Retry</button>
                </div>
            `;
            const overlay = createMessageOverlay(errorMsg, 'error');
            document.body.appendChild(overlay);
        }
        
        function hideMessages() {
            document.querySelectorAll('.message-overlay').forEach(el => el.remove());
        }
        
        function createMessageOverlay(content, type) {
            const overlay = document.createElement('div');
            overlay.className = 'message-overlay';
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.9);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
                color: white;
                font-family: 'Poppins', sans-serif;
            `;
            overlay.innerHTML = content;
            
            if (type === 'loading') {
                overlay.innerHTML += `
                    <style>
                        @keyframes spin {
                            0% { transform: rotate(0deg); }
                            100% { transform: rotate(360deg); }
                        }
                        .spinner {
                            border: 4px solid rgba(255,255,255,0.3);
                            border-top: 4px solid var(--red-primary);
                            border-radius: 50%;
                            width: 50px;
                            height: 50px;
                            animation: spin 1s linear infinite;
                            margin: 20px auto;
                        }
                
        /* ===== SONG PLAYER OVERLAY ===== */
        .song-player-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(30px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 99999;
            animation: fadeIn 0.3s ease;
        }

        .song-player-overlay.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .song-player-content {
            width: 90%;
            max-width: 450px;
            background: linear-gradient(145deg, rgba(227, 27, 35, 0.1), rgba(0, 0, 0, 0.3));
            backdrop-filter: blur(40px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 30px;
            padding: 40px 30px 30px;
            text-align: center;
            position: relative;
            box-shadow: 
                0 30px 80px rgba(0, 0, 0, 0.7),
                0 0 100px rgba(227, 27, 35, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            animation: slideUp 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .song-player-close {
            position: absolute;
            top: -15px;
            right: -15px;
            width: 55px;
            height: 55px;
            border-radius: 50%;
            background: linear-gradient(145deg, var(--red-primary), var(--red-bright));
            border: 3px solid rgba(255, 255, 255, 0.2);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 100;
            box-shadow: 
                0 5px 20px rgba(227, 27, 35, 0.5),
                0 0 0 0 rgba(227, 27, 35, 0.4);
            animation: pulseGlow 2s ease-in-out infinite;
        }

        @keyframes pulseGlow {
            0%, 100% {
                box-shadow: 
                    0 5px 20px rgba(227, 27, 35, 0.5),
                    0 0 0 0 rgba(227, 27, 35, 0.4);
            }
            50% {
                box-shadow: 
                    0 5px 30px rgba(227, 27, 35, 0.7),
                    0 0 0 10px rgba(227, 27, 35, 0);
            }
        }

        .song-player-close:hover {
            transform: rotate(90deg) scale(1.15);
            background: linear-gradient(145deg, var(--red-bright), #ff4444);
            box-shadow: 0 8px 30px rgba(255, 0, 0, 0.6);
        }

        .song-player-close:active {
            transform: rotate(90deg) scale(0.95);
        }

        .song-player-cover-wrapper {
            position: relative;
            width: 280px;
            height: 280px;
            margin: 0 auto 30px;
        }

        .song-player-cover {
            width: 100%;
            height: 100%;
            border-radius: 20px;
            box-shadow: 
                0 25px 70px rgba(0, 0, 0, 0.6),
                0 0 0 1px rgba(255, 255, 255, 0.1),
                inset 0 0 50px rgba(0, 0, 0, 0.3);
            object-fit: cover;
            animation: coverFloat 4s ease-in-out infinite;
        }

        @keyframes coverFloat {
            0%, 100% {
                transform: translateY(0) scale(1);
                box-shadow: 
                    0 25px 70px rgba(0, 0, 0, 0.6),
                    0 0 0 1px rgba(255, 255, 255, 0.1);
            }
            50% {
                transform: translateY(-12px) scale(1.02);
                box-shadow: 
                    0 35px 90px rgba(227, 27, 35, 0.4),
                    0 0 0 1px rgba(255, 255, 255, 0.2);
            }
        }

        .song-player-info {
            margin-bottom: 35px;
        }

        .song-player-title {
            font-size: 26px;
            font-weight: 700;
            color: white;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
            line-height: 1.3;
        }

        .song-player-artist {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.75);
            font-weight: 500;
        }

        .song-player-progress-container {
            width: 100%;
            margin-bottom: 12px;
        }

        .song-player-progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            cursor: pointer;
            position: relative;
            transition: height 0.2s ease;
        }

        .song-player-progress-bar:hover {
            height: 10px;
        }

        .song-player-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--red-primary), var(--red-bright));
            width: 0%;
            transition: width 0.1s linear;
            box-shadow: 0 0 15px var(--red-bright);
            position: relative;
        }

        .song-player-progress-fill::after {
            content: '';
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 14px;
            height: 14px;
            background: white;
            border-radius: 50%;
            box-shadow: 
                0 0 10px rgba(227, 27, 35, 0.8),
                0 2px 5px rgba(0, 0, 0, 0.3);
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .song-player-progress-bar:hover .song-player-progress-fill::after {
            opacity: 1;
        }

        .song-player-time {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 10px;
            font-weight: 500;
        }

        .song-player-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        .song-player-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(145deg, var(--red-primary), var(--red-bright));
            border: none;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 
                0 10px 30px rgba(227, 27, 35, 0.5),
                inset 0 -2px 0 rgba(0, 0, 0, 0.2),
                inset 0 2px 0 rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }

        .song-player-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transition: width 0.4s ease, height 0.4s ease;
        }

        .song-player-btn:hover::before {
            width: 100%;
            height: 100%;
        }

        .song-player-btn:hover {
            transform: scale(1.1);
            box-shadow: 
                0 15px 50px rgba(227, 27, 35, 0.7),
                inset 0 -2px 0 rgba(0, 0, 0, 0.2),
                inset 0 2px 0 rgba(255, 255, 255, 0.3);
        }

        .song-player-btn:active {
            transform: scale(0.95);
            box-shadow: 
                0 5px 20px rgba(227, 27, 35, 0.5),
                inset 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        /* Mobile responsive */
        @media (max-width: 768px) {
            .song-player-content {
                width: 95%;
                padding: 35px 25px 25px;
            }

            .song-player-cover-wrapper {
                width: 240px;
                height: 240px;
            }

            .song-player-title {
                font-size: 22px;
            }

            .song-player-artist {
                font-size: 14px;
            }

            .song-player-close {
                width: 50px;
                height: 50px;
                top: -12px;
                right: -12px;
            }

            .song-player-btn {
                width: 65px;
                height: 65px;
            }
        }

        
        @keyframes tapPulse {
            0%, 100% {
                opacity: 0.6;
                transform: translateY(0);
            }
            50% {
                opacity: 1;
                transform: translateY(5px);
            }
        }
    </style>
                    <div class="spinner"></div>
                `;
            }
            
            return overlay;
        }
        
        function updateWrappedUI(stats, topSongs, topArtists) {
            if (!stats || !topSongs || !topArtists) {
                console.warn('‚ö†Ô∏è  No data available yet');
                return;
            }
            
            // ===== SLIDE 2: Total Plays =====
            const totalPlaysEl = document.querySelector('.slide:nth-child(2) .metric-number');
            if (totalPlaysEl) {
                totalPlaysEl.textContent = stats.totalPlays ? stats.totalPlays.toLocaleString() : '0';
                console.log('‚úÖ Updated total plays:', stats.totalPlays);
            }
            
            // ===== SLIDE 3: Total Minutes =====
            const totalMinutesEl = document.querySelector('.slide:nth-child(3) .metric-number');
            if (totalMinutesEl) {
                totalMinutesEl.textContent = stats.totalMinutes ? stats.totalMinutes.toLocaleString() : '0';
                console.log('‚úÖ Updated total minutes:', stats.totalMinutes);
            }
            
            // ===== SLIDES 4-9: Top Songs =====
            // Store for mini player (only top 6 songs for slides 4-9)
            window.currentTopSongs = topSongs.slice(0, 6).map((song, index) => {
                console.log(`üéµ Song ${index + 1}:`, song.song_name, 'Cover URL:', song.cover_url);
                return {
                    name: song.song_name,
                    artist: song.artist_name,
                    audioUrl: song.audio_url,
                    cover: song.cover_url || '/api/placeholder/400/400',
                    rank: index + 1,
                    plays: song.play_count
                };
            });
            
            // Update each top song slide (slides 4-9 = top 6 songs)
            topSongs.slice(0, 6).forEach((song, idx) => {
                const slideNum = idx + 4;
                const slide = document.querySelector(`.slide:nth-child(${slideNum})`);
                
                if (slide) {
                    // Update rank
                    const rankEl = slide.querySelector('.rank-number');
                    if (rankEl) rankEl.textContent = `#${idx + 1}`;
                    
                    // Update song title
                    const titleEl = slide.querySelector('.song-title');
                    if (titleEl) titleEl.textContent = song.song_name;
                    
                    // Update artist name
                    const artistEl = slide.querySelector('.artist-name');
                    if (artistEl) artistEl.textContent = song.artist_name;
                    
                    // Update play count
                    const playsEl = slide.querySelector('.plays');
                    if (playsEl) playsEl.textContent = `${song.play_count} plays`;
                    
                    console.log(`‚úÖ Updated slide ${slideNum}:`, song.song_name);
                }
            });
            
            // ===== SLIDE 4: Top 5 Songs List (from updateWrappedUI) =====
            const topSongsListRealData = document.querySelector('.slide:nth-child(4) .top-list');
            if (topSongsListRealData && topSongs.length > 0) {
                topSongsListRealData.innerHTML = topSongs.slice(0, 5).map((song, index) => {
                    const songData = {
                        name: song.song_name,
                        artist: song.artist_name,
                        cover: song.cover_url || '/api/placeholder/400/400',
                        audioUrl: song.audio_url || '',
                        rank: index + 1,
                        plays: song.play_count
                    };
                    
                    return `
                        <div class="top-item" style="cursor: pointer;" data-song-index="${index}">
                            <div class="item-rank">${index + 1}</div>
                            <img src="${song.cover_url || '/api/placeholder/200/200'}" alt="${song.song_name}" class="item-image">
                            <div class="item-info">
                                <div class="item-name">${song.song_name}</div>
                                <div class="item-stat">${song.play_count} plays</div>
                            </div>
                        </div>
                    `;
                }).join('');
                
                // Add click handlers
                const items = topSongsListRealData.querySelectorAll('.top-item');
                items.forEach((item, index) => {
                    item.addEventListener('click', function(e) {
                        e.stopPropagation();
                        const songData = {
                            name: topSongs[index].song_name,
                            artist: topSongs[index].artist_name,
                            cover: topSongs[index].cover_url || '/api/placeholder/400/400',
                            audioUrl: topSongs[index].audio_url || '',
                            rank: index + 1,
                            plays: topSongs[index].play_count
                        };
                        openSongPlayer(songData, e);
                    });
                });
                
                console.log('‚úÖ Updated top 5 songs list with click handlers (from real data)');
            }
            
            // ===== SLIDE 10: Top Artists =====
            const topArtistsList = document.querySelector('.slide:nth-child(10) .top-list');
            if (topArtistsList && topArtists.length > 0) {
                topArtistsList.innerHTML = topArtists.map((artist, index) => `
                    <div class="top-item">
                        <div class="rank">${index + 1}</div>
                        <div class="info">
                            <div class="name">${artist.name}</div>
                            <div class="count">${artist.play_count} plays</div>
                        </div>
                    </div>
                `).join('');
                console.log('‚úÖ Updated top artists list');
            }
            
            // ===== SLIDE 11: Peak Hour =====
            const peakHourEl = document.querySelector('.slide:nth-child(11) .metric-number');
            if (peakHourEl && stats.peakHour) {
                peakHourEl.textContent = stats.peakHour;
                console.log('‚úÖ Updated peak hour:', stats.peakHour);
            }
            
            // ===== SLIDE 12: Summary Stats =====
            const summaryStats = document.querySelector('.slide:nth-child(12) .summary-stats');
            if (summaryStats) {
                summaryStats.innerHTML = `
                    <div class="stat-item">
                        <div class="stat-value">${stats.totalPlays.toLocaleString()}</div>
                        <div class="stat-label">Total Plays</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${stats.uniqueSongs}</div>
                        <div class="stat-label">Unique Songs</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${stats.uniqueArtists}</div>
                        <div class="stat-label">Artists</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${stats.totalMinutes.toLocaleString()}</div>
                        <div class="stat-label">Minutes</div>
                    </div>
                `;
                console.log('‚úÖ Updated summary stats');
            }
        }


        // ===== SONG PLAYER OVERLAY FUNCTIONS =====
        
        let songPlayerAudio = null;
        // currentPlayingSong already declared above
        let isDraggingProgress = false;
        
        function openSongPlayer(song, event) {
            console.log('üîç DEBUG: openSongPlayer called!');
            console.log('üîç DEBUG: Requested song:', song.name);
            console.log('üîç DEBUG: Current playing song:', currentPlayingSong?.name);
            
            // Prevent slide navigation
            if (event) {
                event.stopPropagation();
            }
            
            // Check if this is the SAME song that's already playing
            const isSameSong = currentPlayingSong && 
                               currentPlayingSong.name === song.name && 
                               currentPlayingSong.artist === song.artist;
            
            if (isSameSong && songPlayerAudio) {
                console.log('üîÑ Same song - reopening overlay without resetting audio');
                
                // Just reopen the overlay, don't reset the audio
                const overlay = document.getElementById('songPlayerOverlay');
                const cover = document.getElementById('songPlayerCover');
                const title = document.getElementById('songPlayerTitle');
                const artist = document.getElementById('songPlayerArtist');
                
                // Update overlay UI
                cover.src = song.cover || '/api/placeholder/400/400';
                title.textContent = song.name || song.song_name || 'Unknown';
                artist.textContent = song.artist || song.artist_name || 'Unknown Artist';
                
                // Event listeners are ALREADY active (we don't remove them on close)
                // Just update the UI to current state
                
                // Update progress bar to current position
                const currentTime = songPlayerAudio.currentTime;
                const duration = songPlayerAudio.duration;
                
                console.log('üîç Current time:', currentTime, 'Duration:', duration);
                
                if (duration && !isNaN(duration) && duration > 0) {
                    const percent = (currentTime / duration) * 100;
                    const progressFill = document.getElementById('songPlayerProgressFill');
                    if (progressFill) {
                        progressFill.style.width = percent + '%';
                    }
                    
                    const currentTimeEl = document.getElementById('songPlayerCurrentTime');
                    const durationEl = document.getElementById('songPlayerDuration');
                    if (currentTimeEl) currentTimeEl.textContent = formatTime(currentTime);
                    if (durationEl) durationEl.textContent = formatTime(duration);
                } else {
                    // If duration not loaded yet, it will update automatically via event listeners
                    console.log('‚ö†Ô∏è Duration not ready, will update automatically');
                }
                
                // Show overlay
                overlay.classList.add('active');
                
                // Update play button to match current state
                if (songPlayerAudio.paused) {
                    updatePlayButtonIcon(true);
                    console.log('‚è∏Ô∏è Audio is paused');
                } else {
                    updatePlayButtonIcon(false);
                    console.log('‚ñ∂Ô∏è Audio is playing');
                }
                
                console.log('‚úÖ Overlay reopened - audio continues from', formatTime(songPlayerAudio.currentTime || 0));
                return; // Exit here, don't continue to reset audio
            }
            
            // If it's a NEW song, continue with normal flow
            console.log('üéµ Opening NEW song player for:', song);
            
            const overlay = document.getElementById('songPlayerOverlay');
            const cover = document.getElementById('songPlayerCover');
            const title = document.getElementById('songPlayerTitle');
            const artist = document.getElementById('songPlayerArtist');
            
            // Set song info
            cover.src = song.cover || '/api/placeholder/400/400';
            title.textContent = song.name || song.song_name || 'Unknown';
            artist.textContent = song.artist || song.artist_name || 'Unknown Artist';
            
            // Store current song (for overlay player)
            window.currentOverlaySong = song;
            currentPlayingSong = song;
            
            // Update mini player too
            miniPlayerCover.src = song.cover || 'https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=200&h=200&fit=crop';
            miniPlayerTitle.textContent = song.name || song.song_name || 'Unknown';
            miniPlayerArtist.textContent = song.artist || song.artist_name || 'Unknown Artist';
            miniPlayer.classList.add('active');
            miniPlayer.classList.remove('hidden');
            miniPlayerToggle.classList.add('show');
            miniPlayerVisible = true;
            
            // Stop existing audio (both overlay and mini player use same audio)
            if (audioPlayer) {
                audioPlayer.pause();
                audioPlayer.currentTime = 0;
            }
            
            if (songPlayerAudio) {
                songPlayerAudio.pause();
                songPlayerAudio.currentTime = 0;
                songPlayerAudio = null;
            }
            
            // Initialize new audio - use the same audioPlayer for both mini and overlay
            if (song.audioUrl || song.audio_url) {
                const audioUrl = song.audioUrl || song.audio_url;
                
                // Set to main audio player (for mini player)
                audioPlayer.src = audioUrl;
                audioPlayer.load();
                
                // Also use same audio for overlay (songPlayerAudio references audioPlayer)
                songPlayerAudio = audioPlayer;
                
                // Event listeners for overlay
                songPlayerAudio.addEventListener('loadedmetadata', updateSongPlayerDuration);
                songPlayerAudio.addEventListener('timeupdate', updateSongPlayerProgress);
                songPlayerAudio.addEventListener('ended', handleSongEnded);
                songPlayerAudio.addEventListener('error', handleAudioError);
                
                console.log('‚úÖ Audio initialized:', audioUrl);
            } else {
                console.warn('‚ö†Ô∏è No audio URL available');
            }
            
            // Show overlay
            overlay.classList.add('active');
            
            // Reset UI
            resetSongPlayerUI();
            
            // Auto-play
            setTimeout(() => {
                if (songPlayerAudio) {
                    songPlayerAudio.play()
                        .then(() => {
                            updatePlayButtonIcon(false);
                            isPlaying = true;
                            miniPlayerIcon.innerHTML = pauseIcon;
                            console.log('‚ñ∂Ô∏è Auto-playing');
                        })
                        .catch(err => {
                            console.warn('Auto-play blocked:', err);
                            updatePlayButtonIcon(true);
                            isPlaying = false;
                            miniPlayerIcon.innerHTML = playIcon;
                        });
                }
            }, 300);
        }
        
        function closeSongPlayer(event) {
            // Prevent slide navigation
            if (event) {
                event.stopPropagation();
            }
            
            const overlay = document.getElementById('songPlayerOverlay');
            
            // DON'T remove event listeners - they need to stay active for when we reopen
            // The listeners are harmless when overlay is closed
            
            // Hide overlay
            overlay.classList.remove('active');
            
            // DON'T reset UI - keep progress for when user reopens
            // resetSongPlayerUI();
            
            // Keep the song reference for mini player
            // window.currentOverlaySong = null;
            
            console.log('‚ùå Song player overlay closed (audio continues in mini player, listeners stay active)');
        }
        
        function reopenSongOverlay(event) {
            console.log('üîç DEBUG: reopenSongOverlay called!');
            
            // Prevent slide navigation
            if (event) {
                event.stopPropagation();
            }
            
            // Check if we have a current song
            if (!currentPlayingSong && !window.currentOverlaySong) {
                console.warn('‚ö†Ô∏è No song to reopen');
                return;
            }
            
            const song = currentPlayingSong || window.currentOverlaySong;
            
            console.log('üîç DEBUG: Current song:', song);
            console.log('üîç DEBUG: songPlayerAudio exists?', !!songPlayerAudio);
            console.log('üîç DEBUG: audioPlayer exists?', !!audioPlayer);
            console.log('üîç DEBUG: Are they the same?', songPlayerAudio === audioPlayer);
            
            if (songPlayerAudio) {
                console.log('üîç DEBUG: Current time BEFORE reopen:', songPlayerAudio.currentTime);
                console.log('üîç DEBUG: Is paused?', songPlayerAudio.paused);
            }
            
            console.log('üîÑ Reopening overlay for:', song);
            
            const overlay = document.getElementById('songPlayerOverlay');
            const cover = document.getElementById('songPlayerCover');
            const title = document.getElementById('songPlayerTitle');
            const artist = document.getElementById('songPlayerArtist');
            
            // Update overlay UI with current song
            cover.src = song.cover || '/api/placeholder/400/400';
            title.textContent = song.name || song.song_name || 'Unknown';
            artist.textContent = song.artist || song.artist_name || 'Unknown Artist';
            
            // Event listeners are ALREADY active (we don't remove them on close)
            // Just update UI to current state
            
            if (songPlayerAudio) {
                // Update progress bar to current position immediately
                const currentTime = songPlayerAudio.currentTime;
                const duration = songPlayerAudio.duration;
                
                console.log('üéµ Current playback position:', formatTime(currentTime), '/', formatTime(duration));
                console.log('üîç DEBUG: Current time AFTER listener setup:', currentTime);
                
                if (duration && !isNaN(duration)) {
                    const percent = (currentTime / duration) * 100;
                    const progressFill = document.getElementById('songPlayerProgressFill');
                    progressFill.style.width = percent + '%';
                    
                    const currentTimeEl = document.getElementById('songPlayerCurrentTime');
                    const durationEl = document.getElementById('songPlayerDuration');
                    currentTimeEl.textContent = formatTime(currentTime);
                    durationEl.textContent = formatTime(duration);
                }
            }
            
            // Show overlay
            overlay.classList.add('active');
            
            // Update UI to match current playback state
            if (songPlayerAudio && !songPlayerAudio.paused) {
                updatePlayButtonIcon(false);
            } else {
                updatePlayButtonIcon(true);
            }
            
            console.log('‚úÖ Overlay reopened - audio continues from', formatTime(songPlayerAudio?.currentTime || 0));
        }
        
        function toggleSongPlayer() {
            if (!songPlayerAudio) {
                console.warn('‚ö†Ô∏è No audio available');
                return;
            }
            
            if (songPlayerAudio.paused) {
                songPlayerAudio.play()
                    .then(() => {
                        updatePlayButtonIcon(false);
                        isPlaying = true;
                        miniPlayerIcon.innerHTML = pauseIcon;
                        console.log('‚ñ∂Ô∏è Playing');
                    })
                    .catch(err => {
                        console.error('Play error:', err);
                        alert('Cannot play audio');
                    });
            } else {
                songPlayerAudio.pause();
                updatePlayButtonIcon(true);
                isPlaying = false;
                miniPlayerIcon.innerHTML = playIcon;
                console.log('‚è∏Ô∏è Paused');
            }
        }
        
        function updatePlayButtonIcon(showPlay) {
            const icon = document.getElementById('songPlayerPlayIcon');
            if (!icon) return;
            
            if (showPlay) {
                // Play icon
                icon.innerHTML = '<path d="M8 5v14l11-7z"/>';
            } else {
                // Pause icon
                icon.innerHTML = '<path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>';
            }
        }
        
        function updateSongPlayerProgress() {
            if (!songPlayerAudio || isDraggingProgress) return;
            
            const currentTime = songPlayerAudio.currentTime;
            const duration = songPlayerAudio.duration;
            
            if (isNaN(duration) || duration === 0) return;
            
            // Update progress bar
            const progressFill = document.getElementById('songPlayerProgressFill');
            const percent = (currentTime / duration) * 100;
            progressFill.style.width = percent + '%';
            
            // Update current time display
            const currentTimeEl = document.getElementById('songPlayerCurrentTime');
            currentTimeEl.textContent = formatTime(currentTime);
        }
        
        function updateSongPlayerDuration() {
            if (!songPlayerAudio) return;
            
            const duration = songPlayerAudio.duration;
            if (isNaN(duration)) return;
            
            const durationEl = document.getElementById('songPlayerDuration');
            durationEl.textContent = formatTime(duration);
            
            console.log('‚è±Ô∏è Duration:', formatTime(duration));
        }
        
        function handleSongEnded() {
            console.log('‚úÖ Song ended');
            updatePlayButtonIcon(true);
            if (songPlayerAudio) {
                songPlayerAudio.currentTime = 0;
            }
        }
        
        function handleAudioError(e) {
            console.error('‚ùå Audio error:', e);
            alert('Cannot load or play this audio file');
            closeSongPlayer();
        }
        
        function resetSongPlayerUI() {
            const progressFill = document.getElementById('songPlayerProgressFill');
            const currentTimeEl = document.getElementById('songPlayerCurrentTime');
            const durationEl = document.getElementById('songPlayerDuration');
            
            if (progressFill) progressFill.style.width = '0%';
            if (currentTimeEl) currentTimeEl.textContent = '0:00';
            if (durationEl) durationEl.textContent = '0:00';
            
            updatePlayButtonIcon(true);
        }
        
        function formatTime(seconds) {
            if (isNaN(seconds) || seconds === Infinity || seconds < 0) return '0:00';
            
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return mins + ':' + (secs < 10 ? '0' : '') + secs;
        }
        
        // ===== PROGRESS BAR DRAG & CLICK FUNCTIONALITY =====
        
        (function initProgressBarControls() {
            const progressBar = document.getElementById('songPlayerProgressBar');
            if (!progressBar) return;
            
            // Click to seek
            progressBar.addEventListener('click', function(e) {
                if (!songPlayerAudio) return;
                
                e.stopPropagation();
                seekToPosition(e, this);
            });
            
            // Mouse drag
            progressBar.addEventListener('mousedown', function(e) {
                if (!songPlayerAudio) return;
                
                e.stopPropagation();
                isDraggingProgress = true;
                
                const onMouseMove = (moveEvent) => {
                    moveEvent.stopPropagation();
                    seekToPosition(moveEvent, progressBar);
                };
                
                const onMouseUp = (upEvent) => {
                    upEvent.stopPropagation();
                    isDraggingProgress = false;
                    document.removeEventListener('mousemove', onMouseMove);
                    document.removeEventListener('mouseup', onMouseUp);
                };
                
                document.addEventListener('mousemove', onMouseMove);
                document.addEventListener('mouseup', onMouseUp);
            });
            
            // Touch drag
            progressBar.addEventListener('touchstart', function(e) {
                if (!songPlayerAudio) return;
                
                e.stopPropagation();
                isDraggingProgress = true;
                
                const onTouchMove = (moveEvent) => {
                    moveEvent.stopPropagation();
                    const touch = moveEvent.touches[0];
                    seekToPosition(touch, progressBar);
                };
                
                const onTouchEnd = (endEvent) => {
                    endEvent.stopPropagation();
                    isDraggingProgress = false;
                    document.removeEventListener('touchmove', onTouchMove);
                    document.removeEventListener('touchend', onTouchEnd);
                };
                
                document.addEventListener('touchmove', onTouchMove);
                document.addEventListener('touchend', onTouchEnd);
            });
        })();
        
        function seekToPosition(event, progressBarElement) {
            if (!songPlayerAudio) return;
            
            const rect = progressBarElement.getBoundingClientRect();
            const clickX = (event.clientX || event.pageX) - rect.left;
            const width = rect.width;
            const percent = Math.max(0, Math.min(1, clickX / width));
            
            const newTime = percent * songPlayerAudio.duration;
            songPlayerAudio.currentTime = newTime;
            
            // Update UI immediately
            const progressFill = document.getElementById('songPlayerProgressFill');
            progressFill.style.width = (percent * 100) + '%';
            
            const currentTimeEl = document.getElementById('songPlayerCurrentTime');
            currentTimeEl.textContent = formatTime(newTime);
        }
        
        // Close overlay when clicking outside content
        document.getElementById('songPlayerOverlay')?.addEventListener('click', function(e) {
            if (e.target === this) {
                closeSongPlayer(e);
            }
        });
        
        // ===== END SONG PLAYER OVERLAY =====
        

                // Initialize
        createParticles();
        updateSlide();
        
        // Set random compliments for all 4 slides
        document.getElementById('minutesCompliment').textContent = getRandomCompliment('totalMinutes');
        document.getElementById('songsCompliment').textContent = getRandomCompliment('totalSongs');
        document.getElementById('topSongCompliment').textContent = getRandomCompliment('topSong');
        document.getElementById('topArtistCompliment').textContent = getRandomCompliment('topArtist');
        
        console.log('‚úÖ Random compliments loaded for all 4 slides');
        
        // Add event listeners for mini player to reopen overlay
        // miniPlayerCover and miniPlayerInfo are already declared at the top
        
        if (miniPlayerCover) {
            miniPlayerCover.addEventListener('click', function(e) {
                e.stopPropagation(); // Prevent event bubbling
                console.log('üîç DEBUG: Mini player cover clicked!');
                reopenSongOverlay(e);
            });
        }
        
        const miniPlayerInfoEl = document.querySelector('.mini-player-info');
        if (miniPlayerInfoEl) {
            miniPlayerInfoEl.addEventListener('click', function(e) {
                e.stopPropagation(); // Prevent event bubbling
                console.log('üîç DEBUG: Mini player info clicked!');
                reopenSongOverlay(e);
            });
        }
        
        console.log('‚úÖ Mini player click handlers attached');
        
        // Load real data from database
        if (window.vidjeTracking) {
            loadWrappedData();
        } else {
            console.warn('‚ö†Ô∏è  Vidje Tracking not loaded. Make sure vidje-tracking.js is included.');
        }
        
        // ===== INTRO MUSIC FUNCTIONALITY =====
        
        console.log('üîß Initializing intro music system...');
        
        // Load intro music on page load
        setTimeout(() => {
            const introAudio = document.getElementById('introMusic');
            console.log('üîç Looking for intro audio element:', introAudio);
            
            if (!introAudio) {
                console.error('‚ùå Audio element #introMusic not found in DOM!');
                return;
            }
            
            // Check if supabase is available
            if (!window.supabase) {
                console.error('‚ùå Supabase client not available! Waiting...');
                // Retry after another second
                setTimeout(arguments.callee, 1000);
                return;
            }
            
            console.log('‚úÖ Supabase client found:', window.supabase);
            
            let isIntroMusicLoaded = false;
            let isIntroMusicPlaying = false;
            
            // Load intro music from Supabase
            
            // Load intro music from Supabase
            
            // Load intro music from Supabase
            async function loadIntroMusic() {
                try {
                    console.log('üéµ Loading intro music from Supabase...');
                    console.log('üîç Supabase client:', window.supabase ? 'Available' : 'NOT AVAILABLE');
                    
                    if (!window.supabase) {
                        console.error('‚ùå Supabase client not initialized!');
                        return false;
                    }
                    
                    // Get public URL
                    console.log('üì° Requesting public URL for intro.mp3...');
                    const { data, error } = window.supabase.storage
                        .from('vidje')
                        .getPublicUrl('intromusic/intro.mp3');
                    
                    if (error) {
                        console.error('‚ùå Error getting intro music URL:', error);
                        return false;
                    }
                    
                    if (data && data.publicUrl) {
                        const url = data.publicUrl;
                        console.log('üìç Got URL:', url);
                        
                        // Test fetch first
                        console.log('üîç Testing if file is accessible...');
                        try {
                            const response = await fetch(url, { method: 'HEAD' });
                            console.log('üìä Fetch response:', response.status, response.statusText);
                            
                            if (!response.ok) {
                                console.error('‚ùå File not accessible (HTTP ' + response.status + ')');
                                console.error('üí° Check if bucket vidje is public and file intromusic/intro.mp3 exists in Supabase Storage settings');
                                return false;
                            }
                            console.log('‚úÖ File accessible');
                        } catch (fetchErr) {
                            console.error('‚ùå Cannot fetch file:', fetchErr.message);
                            console.error('üí° Possible CORS issue or file does not exist');
                            return false;
                        }
                        
                        // Now set the audio source
                        console.log('üéß Setting audio src...');
                        introAudio.src = url;
                        
                        // Wait for it to load
                        console.log('‚è≥ Waiting for audio to load...');
                        await new Promise((resolve, reject) => {
                            const timeout = setTimeout(() => {
                                reject(new Error('Load timeout after 10s'));
                            }, 10000);
                            
                            introAudio.addEventListener('canplaythrough', () => {
                                clearTimeout(timeout);
                                resolve();
                            }, { once: true });
                            
                            introAudio.addEventListener('error', (e) => {
                                clearTimeout(timeout);
                                reject(new Error('Audio load error: ' + (e.message || 'unknown')));
                            }, { once: true });
                            
                            introAudio.load();
                        });
                        
                        console.log('‚úÖ Intro music loaded and ready');
                        isIntroMusicLoaded = true;
                        
                        // Expose globally
                        window.introMusicUrl = url;
                        window.introMusicElement = introAudio;
                        
                        return true;
                    } else {
                        console.warn('‚ö†Ô∏è No public URL returned');
                        return false;
                    }
                } catch (err) {
                    console.error('‚ùå Error loading intro music:', err.message);
                    console.error('Stack:', err.stack);
                    return false;
                }
            }
            
            function fadeInIntroMusic(duration = 1000, targetVolume = 0.5) {
                if (isIntroMusicPlaying) return;
                
                introAudio.volume = 0;
                introAudio.play()
                    .then(() => {
                        isIntroMusicPlaying = true;
                        const fadeStep = targetVolume / (duration / 50);
                        
                        const fadeInterval = setInterval(() => {
                            if (introAudio.volume < targetVolume - fadeStep) {
                                introAudio.volume += fadeStep;
                            } else {
                                introAudio.volume = targetVolume;
                                clearInterval(fadeInterval);
                                console.log('üîä Intro music faded in');
                            }
                        }, 50);
                    })
                    .catch(err => console.error('‚ùå Error fading in intro music:', err));
            }
            
            // Expose functions globally
            window.fadeOutIntroMusic = fadeOutIntroMusic;
            window.fadeInIntroMusic = fadeInIntroMusic;
            window.setIntroMusicPlaying = (playing) => { isIntroMusicPlaying = playing; };
            window.isIntroMusicPlaying = () => isIntroMusicPlaying;
            
            // Override updateSlide to track currentSlide globally
            const originalUpdateSlide = window.updateSlide;
            window.updateSlide = function() {
                if (originalUpdateSlide) originalUpdateSlide();
                
                // Update global currentSlide reference
                window.currentSlide = currentSlide;
            };
            
            console.log('‚úÖ Intro music system initialized');
            
            console.log('üìû Calling loadIntroMusic()...');
            
            // Disable button sementara
            const startBtn = document.querySelector('.splash-button');
            if (startBtn) {
                startBtn.disabled = true;
                startBtn.style.opacity = '0.5';
                startBtn.textContent = 'Loading music...';
            }
            
            loadIntroMusic().then(success => {
                // Re-enable button
                if (startBtn) {
                    startBtn.disabled = false;
                    startBtn.style.opacity = '1';
                    startBtn.textContent = 'MULAI SEKARANG';
                }
                
                if (success) {
                    console.log('‚úÖ Intro music ready!');
                } else {
                    console.warn('‚ö†Ô∏è Intro music failed to load, will start from slide 4');
                }
            });
            
            
        }, 2000); // Delay 2 detik untuk pastikan supabase sudah ready
        
        // ===== MUTE/UNMUTE FUNCTIONALITY =====
        let isMuted = false;

        function toggleMute(event) {
            // PREVENT SLIDE NAVIGATION
            if (event) {
                event.stopPropagation();
            }
            
            const audioPlayer = document.getElementById('audioPlayer');
            const introMusic = document.getElementById('introMusic');
            const muteButton = document.getElementById('muteButton');
            const muteIcon = document.getElementById('muteIcon');
            
            isMuted = !isMuted;
            
            // Mute/unmute all audio elements
            if (audioPlayer) audioPlayer.muted = isMuted;
            if (introMusic) introMusic.muted = isMuted;
            
            // Update button appearance WITH ANIMATION
            if (isMuted) {
                muteButton.classList.add('muted');
                muteButton.title = 'Unmute Audio';
                // Trigger shake animation
                muteButton.style.animation = 'shake 0.5s ease';
                setTimeout(() => muteButton.style.animation = '', 500);
                
                // Change to muted icon (speaker with X)
                muteIcon.innerHTML = '<path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/>';
                
                console.log('üîá Audio muted');
            } else {
                muteButton.classList.remove('muted');
                muteButton.title = 'Mute Audio';
                // Trigger pulse animation
                muteButton.style.animation = 'unmutePulse 0.5s ease';
                setTimeout(() => muteButton.style.animation = '', 500);
                
                // Change back to unmuted icon (normal speaker)
                muteIcon.innerHTML = '<path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>';
                
                console.log('üîä Audio unmuted');
            }
            
            // Save mute state
            localStorage.setItem('wrappedMuted', isMuted.toString());
        }

        // Initialize mute state from localStorage (remember user preference)
        window.addEventListener('DOMContentLoaded', () => {
            const savedMuteState = localStorage.getItem('wrappedMuted');
            if (savedMuteState === 'true') {
                toggleMute();
            }
        });

        // Save mute state when changed
        document.addEventListener('DOMContentLoaded', () => {
            const muteButton = document.getElementById('muteButton');
            if (muteButton) {
                muteButton.addEventListener('click', () => {
                    localStorage.setItem('wrappedMuted', isMuted.toString());
                });
            }
        });
        
    </script>
</body>
</html>
